<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>qwqbot | qwqbot</title><meta name="author" content="qwqbot"><meta name="copyright" content="qwqbot"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="DES&#x2F;3DES 编码实验报告 10185300229 王鼎 一. 实验环境 1.操作系统 　　	操作机：Linux_Ubuntu 2.实验工具 　　	信息安全综合实验系统 二. 实验内容  掌握分组密码DES&#x2F;3DES的原理 熟练掌握通过用DES算法对实际的数据进行加密和解密 熟悉掌握3DES算法的实际运用 根据给出的3DES算法简单实现代码源程序  DES介绍 数据加密标准DES是由IBM公司">
<meta property="og:type" content="article">
<meta property="og:title" content="qwqbot">
<meta property="og:url" content="http://qwqbot.com/CS0804n/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/CS0804n/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/%E7%AC%AC2%E6%AC%A1%E5%AE%9E%E9%AA%8C/index.html">
<meta property="og:site_name" content="qwqbot">
<meta property="og:description" content="DES&#x2F;3DES 编码实验报告 10185300229 王鼎 一. 实验环境 1.操作系统 　　	操作机：Linux_Ubuntu 2.实验工具 　　	信息安全综合实验系统 二. 实验内容  掌握分组密码DES&#x2F;3DES的原理 熟练掌握通过用DES算法对实际的数据进行加密和解密 熟悉掌握3DES算法的实际运用 根据给出的3DES算法简单实现代码源程序  DES介绍 数据加密标准DES是由IBM公司">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2021-04-12T15:29:23.078Z">
<meta property="article:modified_time" content="2021-04-12T15:50:23.407Z">
<meta property="article:author" content="qwqbot">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/qwq_circle2.jpg"><link rel="canonical" href="http://qwqbot.com/CS0804n/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/CS0804n/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/%E7%AC%AC2%E6%AC%A1%E5%AE%9E%E9%AA%8C/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-04-12 23:50:23'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/qwq_circle2.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">48</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">24</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">qwqbot</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">无题</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-04-12T15:29:23.078Z" title="发表于 2021-04-12 23:29:23">2021-04-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-04-12T15:50:23.407Z" title="更新于 2021-04-12 23:50:23">2021-04-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CS0804n/">CS0804n</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CS0804n/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CS0804n/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/">实验报告</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><center style="font-size:40px;color:#333333;">DES/3DES 编码实验报告</center>
<center style="font-size:20px;color:#333333;">10185300229 王鼎</center>
<h2 id="一-实验环境">一. 实验环境</h2>
<p><strong>1.操作系统</strong><br>
　　	操作机：Linux_Ubuntu</p>
<p><strong>2.实验工具</strong><br>
　　	信息安全综合实验系统</p>
<h2 id="二-实验内容">二. 实验内容</h2>
<ul>
<li>掌握分组密码DES/3DES的原理</li>
<li>熟练掌握通过用DES算法对实际的数据进行加密和解密</li>
<li>熟悉掌握3DES算法的实际运用</li>
<li>根据给出的3DES算法简单实现代码源程序</li>
</ul>
<p><strong>DES介绍</strong></p>
<p>数据加密标准DES是由IBM公司研制的，1977年美国国家标准局批准它供非机密机构保密通信使用，它是一种典型的传统密码体制，它利用传统的换位和置换等加密方法，是目前最为常用的分组密码系统．DES是Data Encryption Standard（数据加密标准）的缩写。它是由IBM公司研制的一种加密算法，美国国家标准局于1977年公布把它作为非机要部门使用的数据加密标准，二十年来，它一直活跃在国际保密通信的舞台上，扮演了十分重要的角色。</p>
<p>DES是一个分组加密算法，他以64位为分组对数据加密。同时DES也是一个对称算法：加密和解密用的是同一个算法。它的密匙长度是56位（因为每个第8 位都用作奇偶校验），密匙可以是任意的56位的数，而且可以任意时候改变。其中有极少量的数被认为是弱密匙，但是很容易避开他们。所以保密性依赖于密钥。</p>
<p><strong>DES算法框架</strong></p>
<p>DES对64(bit)位的明文分组M进行操作，M经过一个初始置换IP置换成m0，将m0明文分成左半部分和右半部分m0=(L0，R0)，各32位 长。然后进行16轮完全相同的运算，这些运算被称为函数f，在运算过程中数据与密匙结合。经过16轮后，左，右半部分合在一起经过一个末置换，这样就完成了。</p>
<p>在每一轮中，密匙位移位，然后再从密匙的56位中选出48位。通过一个扩展置换将数据的右半部分扩展成48位，并通过一个异或操作替代成新的32位数据， 在将其置换换一次。这四步运算构成了函数f。然后，通过另一个异或运算，函数f的输出与左半部分结合，其结果成为新的右半部分，原来的右半部分成为新的左半部分。将该操作重复16次，就实现了。</p>
<p><strong>3DES算法</strong></p>
<p>3DES算法是DES算法的一个为了顺应时代发展的成长和过渡，有兴趣的同学可以查看DES课程来了解3DES密码算法的前生今世。</p>
<p>3DES（即Triple DES）是DES向AES过渡的加密算法，它使用3条56位的密钥对数据进行三次加密。是DES的一个更安全的变形。它以DES为基本模块，通过组合分组方法设计出分组加密算法。比起最初的DES，3DES更为安全。</p>
<p>3DES算法是指使用双长度（16字节）密钥K=（KL||KR）将8字节明文数据块进行3次DES加密/解密。由于计算机运算能力的增强，原版DES密码的密钥长度变得容易被暴力破解；3DES即是设计用来提供一种相对简单的方法，即通过增加DES的密钥长度来避免类似的攻击，而不是设计一种全新的块密码算法。它以DES为基本模块，通过组合分组方法设计出分组加密算法，其具体实现如下：设Ek()和Dk()代表DES算法的加密和解密过程，K代表DES算法使用的密钥，P代表明文，C代表密文。<br>
　　 3DES加密解密过程数学表达式如下：</p>
<p>3DES加密过程为：C=Ek3(Dk2(Ek1(P)))</p>
<p>3DES解密过程为：P=Dk1(EK2(Dk3(C)))</p>
<h2 id="三-实验步骤">三. 实验步骤</h2>
<h3 id="DES编码实验">DES编码实验</h3>
<h4 id="查看DES密码的源码">查看DES密码的源码</h4>
<ol>
<li>
<p>加密中要使用的结构体desstruct.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ip=  (<span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>,</span><br><span class="line">      <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line">      <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span>,</span><br><span class="line">      <span class="number">64</span>, <span class="number">56</span>, <span class="number">48</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span> , <span class="number">1</span>,</span><br><span class="line">      <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>,</span><br><span class="line">      <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>,</span><br><span class="line">      <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">ip_1=(<span class="number">40</span>, <span class="number">8</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">56</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">32</span>,</span><br><span class="line">      <span class="number">39</span>, <span class="number">7</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">55</span>, <span class="number">23</span>, <span class="number">63</span>, <span class="number">31</span>,</span><br><span class="line">      <span class="number">38</span>, <span class="number">6</span>, <span class="number">46</span>, <span class="number">14</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">62</span>, <span class="number">30</span>,</span><br><span class="line">      <span class="number">37</span>, <span class="number">5</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">53</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">29</span>,</span><br><span class="line">      <span class="number">36</span>, <span class="number">4</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">52</span>, <span class="number">20</span>, <span class="number">60</span>, <span class="number">28</span>,</span><br><span class="line">      <span class="number">35</span>, <span class="number">3</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">51</span>, <span class="number">19</span>, <span class="number">59</span>, <span class="number">27</span>,</span><br><span class="line">      <span class="number">34</span>, <span class="number">2</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">26</span>,</span><br><span class="line">      <span class="number">33</span>, <span class="number">1</span>, <span class="number">41</span>,  <span class="number">9</span>, <span class="number">49</span>, <span class="number">17</span>, <span class="number">57</span>, <span class="number">25</span>)</span><br><span class="line"></span><br><span class="line">e  =(<span class="number">32</span>, <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">4</span>,  <span class="number">5</span>, </span><br><span class="line">       <span class="number">6</span>, <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>,  <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, </span><br><span class="line">      <span class="number">12</span>,<span class="number">13</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>,</span><br><span class="line">      <span class="number">16</span>,<span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">20</span>, <span class="number">21</span>,</span><br><span class="line">      <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>,<span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>,</span><br><span class="line">      <span class="number">28</span>, <span class="number">29</span>,<span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>,  <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">p=(<span class="number">16</span>,  <span class="number">7</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">29</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">17</span>,</span><br><span class="line">     <span class="number">1</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">26</span>,  <span class="number">5</span>, <span class="number">18</span>, <span class="number">31</span>, <span class="number">10</span>, </span><br><span class="line">     <span class="number">2</span>,  <span class="number">8</span>, <span class="number">24</span>, <span class="number">14</span>, <span class="number">32</span>, <span class="number">27</span>,  <span class="number">3</span>,  <span class="number">9</span>,</span><br><span class="line">     <span class="number">19</span>, <span class="number">13</span>, <span class="number">30</span>, <span class="number">6</span>, <span class="number">22</span>, <span class="number">11</span>,  <span class="number">4</span>,  <span class="number">25</span>)</span><br><span class="line"></span><br><span class="line">s=[ [[<span class="number">14</span>, <span class="number">4</span>, <span class="number">13</span>,  <span class="number">1</span>,  <span class="number">2</span>, <span class="number">15</span>, <span class="number">11</span>,  <span class="number">8</span>,  <span class="number">3</span>, <span class="number">10</span>,  <span class="number">6</span>, <span class="number">12</span>,  <span class="number">5</span>,  <span class="number">9</span>,  <span class="number">0</span>,  <span class="number">7</span>],</span><br><span class="line">     [<span class="number">0</span>, <span class="number">15</span>,  <span class="number">7</span>,  <span class="number">4</span>, <span class="number">14</span>,  <span class="number">2</span>, <span class="number">13</span>,  <span class="number">1</span>, <span class="number">10</span>,  <span class="number">6</span>, <span class="number">12</span>, <span class="number">11</span>,  <span class="number">9</span>,  <span class="number">5</span>,  <span class="number">3</span>,  <span class="number">8</span>],</span><br><span class="line">     [<span class="number">4</span>,  <span class="number">1</span>, <span class="number">14</span>,  <span class="number">8</span>, <span class="number">13</span>,  <span class="number">6</span>,  <span class="number">2</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">12</span>,  <span class="number">9</span>,  <span class="number">7</span>,  <span class="number">3</span>, <span class="number">10</span>,  <span class="number">5</span>,  <span class="number">0</span>],    </span><br><span class="line">     [<span class="number">15</span>, <span class="number">12</span>,  <span class="number">8</span>,  <span class="number">2</span>,  <span class="number">4</span>,  <span class="number">9</span>,  <span class="number">1</span>,  <span class="number">7</span>,  <span class="number">5</span>, <span class="number">11</span>,  <span class="number">3</span>, <span class="number">14</span>, <span class="number">10</span>,  <span class="number">0</span>,  <span class="number">6</span>, <span class="number">13</span>]],</span><br><span class="line"></span><br><span class="line">     [[<span class="number">15</span>,  <span class="number">1</span>,  <span class="number">8</span>, <span class="number">14</span>,  <span class="number">6</span>, <span class="number">11</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">9</span>,  <span class="number">7</span>,  <span class="number">2</span>, <span class="number">13</span>, <span class="number">12</span>,  <span class="number">0</span>,  <span class="number">5</span>, <span class="number">10</span>],     </span><br><span class="line">     [<span class="number">3</span>, <span class="number">13</span>,  <span class="number">4</span>,  <span class="number">7</span>, <span class="number">15</span>,  <span class="number">2</span>,  <span class="number">8</span>, <span class="number">14</span>, <span class="number">12</span>,  <span class="number">0</span>,  <span class="number">1</span>, <span class="number">10</span>,  <span class="number">6</span>,  <span class="number">9</span>, <span class="number">11</span>,  <span class="number">5</span>],     </span><br><span class="line">     [<span class="number">0</span>, <span class="number">14</span>,  <span class="number">7</span>, <span class="number">11</span>, <span class="number">10</span>,  <span class="number">4</span>, <span class="number">13</span>,  <span class="number">1</span>,  <span class="number">5</span>,  <span class="number">8</span>, <span class="number">12</span>,  <span class="number">6</span>,  <span class="number">9</span>,  <span class="number">3</span>,  <span class="number">2</span>, <span class="number">15</span>],     </span><br><span class="line">     [<span class="number">13</span>,  <span class="number">8</span>, <span class="number">10</span>,  <span class="number">1</span>,  <span class="number">3</span>, <span class="number">15</span>,  <span class="number">4</span>,  <span class="number">2</span>, <span class="number">11</span>,  <span class="number">6</span>,  <span class="number">7</span>, <span class="number">12</span>,  <span class="number">0</span>,  <span class="number">5</span>, <span class="number">14</span>,  <span class="number">9</span>]],</span><br><span class="line"></span><br><span class="line">     [[<span class="number">10</span>,  <span class="number">0</span>,  <span class="number">9</span>, <span class="number">14</span>,  <span class="number">6</span>,  <span class="number">3</span>, <span class="number">15</span>,  <span class="number">5</span>,  <span class="number">1</span>, <span class="number">13</span>, <span class="number">12</span>,  <span class="number">7</span>, <span class="number">11</span>,  <span class="number">4</span>,  <span class="number">2</span>,  <span class="number">8</span>],     </span><br><span class="line">     [<span class="number">13</span>,  <span class="number">7</span>,  <span class="number">0</span>,  <span class="number">9</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">6</span>, <span class="number">10</span>,  <span class="number">2</span>,  <span class="number">8</span>,  <span class="number">5</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">15</span>,  <span class="number">1</span>],   </span><br><span class="line">     [<span class="number">13</span>,  <span class="number">6</span>,  <span class="number">4</span>,  <span class="number">9</span>,  <span class="number">8</span>, <span class="number">15</span>,  <span class="number">3</span>,  <span class="number">0</span>, <span class="number">11</span>,  <span class="number">1</span>,  <span class="number">2</span>, <span class="number">12</span>,  <span class="number">5</span>, <span class="number">10</span>, <span class="number">14</span>,  <span class="number">7</span>],     </span><br><span class="line">     [<span class="number">1</span>, <span class="number">10</span>, <span class="number">13</span>,  <span class="number">0</span>,  <span class="number">6</span>,  <span class="number">9</span>,  <span class="number">8</span>,  <span class="number">7</span>,  <span class="number">4</span>, <span class="number">15</span>, <span class="number">14</span>,  <span class="number">3</span>, <span class="number">11</span>,  <span class="number">5</span>,  <span class="number">2</span>, <span class="number">12</span>]],</span><br><span class="line"></span><br><span class="line">    [[<span class="number">7</span>, <span class="number">13</span>, <span class="number">14</span>,  <span class="number">3</span>,  <span class="number">0</span>,  <span class="number">6</span>,  <span class="number">9</span>, <span class="number">10</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">8</span>,  <span class="number">5</span>, <span class="number">11</span>,  <span class="number">12</span>,  <span class="number">4</span>, <span class="number">15</span>],     </span><br><span class="line">     [<span class="number">13</span>,  <span class="number">8</span>, <span class="number">11</span>,  <span class="number">5</span>,  <span class="number">6</span>, <span class="number">15</span>,  <span class="number">0</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">7</span>,  <span class="number">2</span>, <span class="number">12</span>,  <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>,<span class="number">9</span>],     </span><br><span class="line">     [<span class="number">10</span>,  <span class="number">6</span>,  <span class="number">9</span>,  <span class="number">0</span>, <span class="number">12</span>, <span class="number">11</span>,  <span class="number">7</span>, <span class="number">13</span>, <span class="number">15</span>,  <span class="number">1</span>,  <span class="number">3</span>, <span class="number">14</span>,  <span class="number">5</span>,  <span class="number">2</span>,  <span class="number">8</span>,  <span class="number">4</span>],     </span><br><span class="line">     [<span class="number">3</span>, <span class="number">15</span>,  <span class="number">0</span>,  <span class="number">6</span>, <span class="number">10</span>,  <span class="number">1</span>, <span class="number">13</span>,  <span class="number">8</span>,  <span class="number">9</span>,  <span class="number">4</span>,  <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>,  <span class="number">7</span>,  <span class="number">2</span>, <span class="number">14</span>]],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    [[<span class="number">2</span>, <span class="number">12</span>,  <span class="number">4</span>,  <span class="number">1</span>,  <span class="number">7</span>, <span class="number">10</span>, <span class="number">11</span>,  <span class="number">6</span>,  <span class="number">8</span>,  <span class="number">5</span>,  <span class="number">3</span>, <span class="number">15</span>, <span class="number">13</span>,  <span class="number">0</span>, <span class="number">14</span>,  <span class="number">9</span>],     </span><br><span class="line">     [<span class="number">14</span>, <span class="number">11</span>,  <span class="number">2</span>, <span class="number">12</span>,  <span class="number">4</span>,  <span class="number">7</span>, <span class="number">13</span>,  <span class="number">1</span>,  <span class="number">5</span>,  <span class="number">0</span>, <span class="number">15</span>, <span class="number">10</span>,  <span class="number">3</span>,  <span class="number">9</span>,  <span class="number">8</span>,  <span class="number">6</span>],     </span><br><span class="line">     [<span class="number">4</span>,  <span class="number">2</span>,  <span class="number">1</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">13</span>,  <span class="number">7</span>,  <span class="number">8</span>, <span class="number">15</span>,  <span class="number">9</span>, <span class="number">12</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">3</span>,  <span class="number">0</span>, <span class="number">14</span>],     </span><br><span class="line">     [<span class="number">11</span>,  <span class="number">8</span>, <span class="number">12</span>,  <span class="number">7</span>,  <span class="number">1</span>, <span class="number">14</span>,  <span class="number">2</span>, <span class="number">13</span>,  <span class="number">6</span>, <span class="number">15</span>,  <span class="number">0</span>,  <span class="number">9</span>, <span class="number">10</span>,  <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">3</span>]],</span><br><span class="line"></span><br><span class="line">    [[<span class="number">12</span>,  <span class="number">1</span>, <span class="number">10</span>, <span class="number">15</span>,  <span class="number">9</span>,  <span class="number">2</span>,  <span class="number">6</span>,  <span class="number">8</span>,  <span class="number">0</span>, <span class="number">13</span>,  <span class="number">3</span>,  <span class="number">4</span>, <span class="number">14</span>,  <span class="number">7</span>,  <span class="number">5</span>, <span class="number">11</span>],</span><br><span class="line">     [<span class="number">10</span>, <span class="number">15</span>,  <span class="number">4</span>,  <span class="number">2</span>,  <span class="number">7</span>, <span class="number">12</span>,  <span class="number">9</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">1</span>, <span class="number">13</span>, <span class="number">14</span>,  <span class="number">0</span>, <span class="number">11</span>,  <span class="number">3</span>,  <span class="number">8</span>],     </span><br><span class="line">     [<span class="number">9</span>, <span class="number">14</span>, <span class="number">15</span>,  <span class="number">5</span>,  <span class="number">2</span>,  <span class="number">8</span>, <span class="number">12</span>,  <span class="number">3</span>,  <span class="number">7</span>,  <span class="number">0</span>,  <span class="number">4</span>, <span class="number">10</span>,  <span class="number">1</span>, <span class="number">13</span>, <span class="number">11</span>,  <span class="number">6</span>],     </span><br><span class="line">     [<span class="number">4</span>,  <span class="number">3</span>,  <span class="number">2</span>, <span class="number">12</span>,  <span class="number">9</span>,  <span class="number">5</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">14</span>,  <span class="number">1</span>,  <span class="number">7</span>,  <span class="number">6</span>,  <span class="number">0</span>,  <span class="number">8</span>, <span class="number">13</span>]],</span><br><span class="line"></span><br><span class="line">    [[<span class="number">4</span>, <span class="number">11</span>,  <span class="number">2</span>, <span class="number">14</span>, <span class="number">15</span>,  <span class="number">0</span>,  <span class="number">8</span>, <span class="number">13</span>,  <span class="number">3</span>, <span class="number">12</span>,  <span class="number">9</span>,  <span class="number">7</span>,  <span class="number">5</span>, <span class="number">10</span>,  <span class="number">6</span>,  <span class="number">1</span>],     </span><br><span class="line">     [<span class="number">13</span>,  <span class="number">0</span>, <span class="number">11</span>,  <span class="number">7</span>,  <span class="number">4</span>,  <span class="number">9</span>,  <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>,  <span class="number">3</span>,  <span class="number">5</span>, <span class="number">12</span>,  <span class="number">2</span>, <span class="number">15</span>,  <span class="number">8</span>,  <span class="number">6</span>],     </span><br><span class="line">     [<span class="number">1</span>,  <span class="number">4</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">12</span>,  <span class="number">3</span>,  <span class="number">7</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">15</span>,  <span class="number">6</span>,  <span class="number">8</span>,  <span class="number">0</span>,  <span class="number">5</span>,  <span class="number">9</span>,  <span class="number">2</span>],     </span><br><span class="line">     [<span class="number">6</span>, <span class="number">11</span>, <span class="number">13</span>,  <span class="number">8</span>,  <span class="number">1</span>,  <span class="number">4</span>, <span class="number">10</span>,  <span class="number">7</span>,  <span class="number">9</span>,  <span class="number">5</span>,  <span class="number">0</span>, <span class="number">15</span>, <span class="number">14</span>,  <span class="number">2</span>,  <span class="number">3</span>, <span class="number">12</span>]],</span><br><span class="line"></span><br><span class="line">   [[<span class="number">13</span>,  <span class="number">2</span>,  <span class="number">8</span>,  <span class="number">4</span>,  <span class="number">6</span>, <span class="number">15</span>, <span class="number">11</span>,  <span class="number">1</span>, <span class="number">10</span>,  <span class="number">9</span>,  <span class="number">3</span>, <span class="number">14</span>,  <span class="number">5</span>,  <span class="number">0</span>, <span class="number">12</span>,  <span class="number">7</span>],     </span><br><span class="line">     [<span class="number">1</span>, <span class="number">15</span>, <span class="number">13</span>,  <span class="number">8</span>, <span class="number">10</span>,  <span class="number">3</span>,  <span class="number">7</span>,  <span class="number">4</span>, <span class="number">12</span>,  <span class="number">5</span>,  <span class="number">6</span>, <span class="number">11</span>,  <span class="number">0</span>, <span class="number">14</span>,  <span class="number">9</span>,  <span class="number">2</span>],     </span><br><span class="line">     [<span class="number">7</span>, <span class="number">11</span>,  <span class="number">4</span>,  <span class="number">1</span>,  <span class="number">9</span>, <span class="number">12</span>, <span class="number">14</span>,  <span class="number">2</span>,  <span class="number">0</span>,  <span class="number">6</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>,  <span class="number">3</span>,  <span class="number">5</span>,  <span class="number">8</span>],     </span><br><span class="line">     [<span class="number">2</span>,  <span class="number">1</span>, <span class="number">14</span>,  <span class="number">7</span>,  <span class="number">4</span>, <span class="number">10</span>,  <span class="number">8</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">12</span>,  <span class="number">9</span>,  <span class="number">0</span>,  <span class="number">3</span>,  <span class="number">5</span>,  <span class="number">6</span>, <span class="number">11</span>]]]</span><br><span class="line"></span><br><span class="line">pc1=(<span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>,  <span class="number">9</span>,</span><br><span class="line">       <span class="number">1</span>, <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>,</span><br><span class="line">      <span class="number">10</span>,  <span class="number">2</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>,</span><br><span class="line">      <span class="number">19</span>, <span class="number">11</span>,  <span class="number">3</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>,</span><br><span class="line">      <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>,</span><br><span class="line">       <span class="number">7</span>, <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>,</span><br><span class="line">      <span class="number">14</span>,  <span class="number">6</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>,</span><br><span class="line">      <span class="number">21</span>, <span class="number">13</span>,  <span class="number">5</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">pc2= (<span class="number">14</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">24</span>,  <span class="number">1</span>,  <span class="number">5</span>,  <span class="number">3</span>, <span class="number">28</span>,</span><br><span class="line">      <span class="number">15</span>,  <span class="number">6</span>, <span class="number">21</span>, <span class="number">10</span>, <span class="number">23</span>, <span class="number">19</span>, <span class="number">12</span>,  <span class="number">4</span>, </span><br><span class="line">      <span class="number">26</span>,  <span class="number">8</span>, <span class="number">16</span>,  <span class="number">7</span>, <span class="number">27</span>, <span class="number">20</span>, <span class="number">13</span>,  <span class="number">2</span>, </span><br><span class="line">      <span class="number">41</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">47</span>, <span class="number">55</span>, <span class="number">30</span>, <span class="number">40</span>, </span><br><span class="line">      <span class="number">51</span>, <span class="number">45</span>, <span class="number">33</span>, <span class="number">48</span>, <span class="number">44</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">56</span>, </span><br><span class="line">      <span class="number">34</span>, <span class="number">53</span>, <span class="number">46</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">36</span>, <span class="number">29</span>, <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">d = (  <span class="number">1</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">2</span>,  <span class="number">2</span>,  <span class="number">2</span>,  <span class="number">2</span>,  <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>加密文件desjiami.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#_*_ coding:utf-8 _*_</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#Filename:des.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> desstruct <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">__all__=[<span class="string">&#x27;desencode&#x27;</span>]</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DES</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;des 加密&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="comment">#加密</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">code</span>(<span class="params">self,from_code,key,code_len,key_len</span>):</span></span><br><span class="line">        output=<span class="string">&quot;&quot;</span></span><br><span class="line">        trun_len=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#将密文和密钥转换为二进制</span></span><br><span class="line">        code_string=self._functionCharToA(from_code,code_len)</span><br><span class="line">        code_key=self._functionCharToA(key,key_len)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#如果密钥长度不是16的整数倍则以增加0的方式变为16的整数倍</span></span><br><span class="line">        <span class="keyword">if</span> code_len%<span class="number">16</span>!=<span class="number">0</span>:</span><br><span class="line">            real_len=(code_len/<span class="number">16</span>)*<span class="number">16</span>+<span class="number">16</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            real_len=code_len</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> key_len%<span class="number">16</span>!=<span class="number">0</span>:</span><br><span class="line">            key_len=(key_len/<span class="number">16</span>)*<span class="number">16</span>+<span class="number">16</span></span><br><span class="line">        key_len*=<span class="number">4</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#每个16进制占4位</span></span><br><span class="line">        trun_len=<span class="number">4</span>*real_len</span><br><span class="line">        <span class="comment">#对每64位进行一次加密</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,trun_len,<span class="number">64</span>):</span><br><span class="line">            run_code=code_string[i:i+<span class="number">64</span>]</span><br><span class="line">            l=i%key_len</span><br><span class="line">            run_key=code_key[l:l+<span class="number">64</span>]</span><br><span class="line"></span><br><span class="line">            <span class="comment">#64位明文、密钥初始置换</span></span><br><span class="line">            run_code= self._codefirstchange(run_code)</span><br><span class="line">            run_key= self._keyfirstchange(run_key)</span><br><span class="line"></span><br><span class="line">            <span class="comment">#16次迭代</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line"></span><br><span class="line">                <span class="comment">#取出明文左右32位</span></span><br><span class="line">                code_r=run_code[<span class="number">32</span>:<span class="number">64</span>]</span><br><span class="line">                code_l=run_code[<span class="number">0</span>:<span class="number">32</span>]</span><br><span class="line"></span><br><span class="line">                <span class="comment">#64左右交换</span></span><br><span class="line">                run_code=code_r</span><br><span class="line"></span><br><span class="line">                <span class="comment">#右边32位扩展置换</span></span><br><span class="line">                code_r= self._functionE(code_r)</span><br><span class="line"></span><br><span class="line">                <span class="comment">#获取本轮子密钥</span></span><br><span class="line">                key_l=run_key[<span class="number">0</span>:<span class="number">28</span>]</span><br><span class="line">                key_r=run_key[<span class="number">28</span>:<span class="number">56</span>]</span><br><span class="line">                key_l=key_l[d[j]:<span class="number">28</span>]+key_l[<span class="number">0</span>:d[j]]</span><br><span class="line">                key_r=key_r[d[j]:<span class="number">28</span>]+key_r[<span class="number">0</span>:d[j]]</span><br><span class="line">                run_key=key_l+key_r</span><br><span class="line">                key_y= self._functionKeySecondChange(run_key)</span><br><span class="line"></span><br><span class="line">                <span class="comment">#异或</span></span><br><span class="line">                code_r= self._codeyihuo(code_r,key_y)</span><br><span class="line"></span><br><span class="line">                <span class="comment">#S盒代替/选择</span></span><br><span class="line">                code_r= self._functionS(code_r)</span><br><span class="line"></span><br><span class="line">                <span class="comment">#P转换</span></span><br><span class="line">                code_r= self._functionP(code_r)</span><br><span class="line"></span><br><span class="line">                <span class="comment">#异或</span></span><br><span class="line">                code_r= self._codeyihuo(code_l,code_r)</span><br><span class="line">                run_code+=code_r</span><br><span class="line">            <span class="comment">#32互换</span></span><br><span class="line">            code_r=run_code[<span class="number">32</span>:<span class="number">64</span>]</span><br><span class="line">            code_l=run_code[<span class="number">0</span>:<span class="number">32</span>]</span><br><span class="line">            run_code=code_r+code_l</span><br><span class="line"></span><br><span class="line">            <span class="comment">#将二进制转换为16进制、逆初始置换</span></span><br><span class="line">            output+=self._functionCodeChange(run_code)</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">    <span class="comment">#异或    </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_codeyihuo</span>(<span class="params">self,code,key</span>):</span></span><br><span class="line">        code_len=<span class="built_in">len</span>(key)</span><br><span class="line">        return_list=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(code_len):</span><br><span class="line">            <span class="keyword">if</span> code[i]==key[i]:</span><br><span class="line">                return_list+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                return_list+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> return_list</span><br><span class="line"></span><br><span class="line">    <span class="comment">#密文或明文初始置换                                              </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_codefirstchange</span>(<span class="params">self,code</span>):</span></span><br><span class="line">        changed_code=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            changed_code+=code[ip[i]-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> changed_code</span><br><span class="line"></span><br><span class="line">    <span class="comment">#密钥初始置换</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_keyfirstchange</span> (<span class="params">self,key</span>):</span></span><br><span class="line">        changed_key=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">56</span>):</span><br><span class="line">            changed_key+=key[pc1[i]-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> changed_key</span><br><span class="line"></span><br><span class="line">    <span class="comment">#逆初始置换</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_functionCodeChange</span>(<span class="params">self, code</span>):</span></span><br><span class="line">        lens=<span class="built_in">len</span>(code)/<span class="number">4</span></span><br><span class="line">        return_list=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(lens):</span><br><span class="line">            <span class="built_in">list</span>=<span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                <span class="built_in">list</span>+=code[ip_1[i*<span class="number">4</span>+j]-<span class="number">1</span>]</span><br><span class="line">            return_list+=<span class="string">&quot;%x&quot;</span> %<span class="built_in">int</span>(<span class="built_in">list</span>,<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> return_list</span><br><span class="line"></span><br><span class="line">    <span class="comment">#扩展置换    </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_functionE</span>(<span class="params">self,code</span>):</span></span><br><span class="line">        return_list=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">            return_list+=code[e[i]-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> return_list        </span><br><span class="line"></span><br><span class="line">    <span class="comment">#置换P        </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_functionP</span>(<span class="params">self,code</span>):</span></span><br><span class="line">        return_list=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            return_list+=code[p[i]-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> return_list</span><br><span class="line"></span><br><span class="line">    <span class="comment">#S盒代替选择置换</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_functionS</span>(<span class="params">self, key</span>):</span></span><br><span class="line">        return_list=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            row=<span class="built_in">int</span>( <span class="built_in">str</span>(key[i*<span class="number">6</span>])+<span class="built_in">str</span>(key[i*<span class="number">6</span>+<span class="number">5</span>]),<span class="number">2</span>)</span><br><span class="line">            raw=<span class="built_in">int</span>(<span class="built_in">str</span>( key[i*<span class="number">6</span>+<span class="number">1</span>])+<span class="built_in">str</span>(key[i*<span class="number">6</span>+<span class="number">2</span>])+<span class="built_in">str</span>(key[i*<span class="number">6</span>+<span class="number">3</span>])+<span class="built_in">str</span>(key[i*<span class="number">6</span>+<span class="number">4</span>]),<span class="number">2</span>)</span><br><span class="line">            return_list+=self._functionTos(s[i][row][raw],<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> return_list</span><br><span class="line"></span><br><span class="line">    <span class="comment">#密钥置换选择2</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_functionKeySecondChange</span>(<span class="params">self,key</span>):</span></span><br><span class="line">        return_list=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">            return_list+=key[pc2[i]-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> return_list</span><br><span class="line"></span><br><span class="line">    <span class="comment">#将十六进制转换为二进制字符串</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_functionCharToA</span>(<span class="params">self,code,lens</span>):</span></span><br><span class="line">        return_code=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        lens=lens%<span class="number">16</span></span><br><span class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> code:</span><br><span class="line">            code_ord=<span class="built_in">int</span>(key,<span class="number">16</span>)</span><br><span class="line">            return_code+=self._functionTos(code_ord,<span class="number">4</span>)        </span><br><span class="line">        <span class="keyword">if</span> lens!=<span class="number">0</span>:</span><br><span class="line">            return_code+=<span class="string">&#x27;0&#x27;</span>*(<span class="number">16</span>-lens)*<span class="number">4</span></span><br><span class="line">        <span class="keyword">return</span> return_code</span><br><span class="line"></span><br><span class="line">    <span class="comment">#二进制转换</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_functionTos</span>(<span class="params">self,o,lens</span>):</span></span><br><span class="line">        return_code=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(lens):</span><br><span class="line">            return_code=<span class="built_in">str</span>(o&gt;&gt;i &amp;<span class="number">1</span>)+return_code</span><br><span class="line">        <span class="keyword">return</span> return_code</span><br><span class="line"></span><br><span class="line"><span class="comment">#将unicode字符转换为16进制</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tohex</span>(<span class="params">string</span>):</span></span><br><span class="line">    return_string=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string:</span><br><span class="line">        return_string+=<span class="string">&quot;%02x&quot;</span>%<span class="built_in">ord</span>(i)</span><br><span class="line">    <span class="keyword">return</span> return_string</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tounicode</span>(<span class="params">string</span>):</span></span><br><span class="line">    return_string=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    string_len=<span class="built_in">len</span>(string)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,string_len,<span class="number">2</span>):</span><br><span class="line">        return_string+=<span class="built_in">chr</span>(<span class="built_in">int</span>(string[i:i+<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line">    <span class="keyword">return</span> return_string</span><br><span class="line"></span><br><span class="line"><span class="comment">#入口函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">desencode</span>(<span class="params">from_code,key</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#转换为16进制</span></span><br><span class="line">    from_code=tohex(from_code)</span><br><span class="line">    key=tohex(key)</span><br><span class="line"></span><br><span class="line">    des=DES()</span><br><span class="line">    key_len=<span class="built_in">len</span>(key)</span><br><span class="line">    string_len=<span class="built_in">len</span>(from_code)        </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> string_len&lt;<span class="number">1</span> <span class="keyword">or</span> key_len&lt;<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;error input&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    key_code= des.code(from_code,key,string_len,key_len)</span><br><span class="line">    <span class="keyword">return</span> key_code</span><br><span class="line"></span><br><span class="line"><span class="comment">#测试</span></span><br><span class="line"><span class="keyword">if</span> __name__  == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> desencode(<span class="string">&#x27;我是12345678刘就是我abcdwfd&#x27;</span>,<span class="string">&#x27;0f1571c947刘&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>解密文件desjiemi.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#_*_coding:utf-8_*_</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#Filename:des.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> desstruct <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">__all__=[<span class="string">&#x27;desdecode&#x27;</span>]</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DES</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;解密函数，DES加密与解密的方法相差不大</span></span><br><span class="line"><span class="string">        只是在解密的时候所用的子密钥与加密的子密钥相反</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params">self,string,key,key_len,string_len</span>):</span></span><br><span class="line">        output=<span class="string">&quot;&quot;</span></span><br><span class="line">        trun_len=<span class="number">0</span></span><br><span class="line">        num=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#将密文转换为二进制</span></span><br><span class="line">        code_string=self._functionCharToA(string,string_len)</span><br><span class="line">        <span class="comment">#获取字密钥</span></span><br><span class="line">        code_key=self._getkey(key,key_len)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">#如果密钥长度不是16的整数倍则以增加0的方式变为16的整数倍</span></span><br><span class="line">        real_len=(key_len/<span class="number">16</span>)+<span class="number">1</span> <span class="keyword">if</span> key_len%<span class="number">16</span>!=<span class="number">0</span> <span class="keyword">else</span> key_len/<span class="number">16</span></span><br><span class="line">        trun_len=string_len*<span class="number">4</span></span><br><span class="line">        <span class="comment">#对每64位进行一次加密</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,trun_len,<span class="number">64</span>):</span><br><span class="line">            run_code=code_string[i:i+<span class="number">64</span>]</span><br><span class="line">            run_key=code_key[num%real_len]</span><br><span class="line"></span><br><span class="line">            <span class="comment">#64位明文初始置换</span></span><br><span class="line">            run_code= self._codefirstchange(run_code)</span><br><span class="line"></span><br><span class="line">            <span class="comment">#16次迭代</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line"></span><br><span class="line">                code_r=run_code[<span class="number">32</span>:<span class="number">64</span>]</span><br><span class="line">                code_l=run_code[<span class="number">0</span>:<span class="number">32</span>]</span><br><span class="line"></span><br><span class="line">                <span class="comment">#64左右交换    </span></span><br><span class="line">                run_code=code_r</span><br><span class="line"></span><br><span class="line">                <span class="comment">#右边32位扩展置换</span></span><br><span class="line">                code_r= self._functionE(code_r)</span><br><span class="line"></span><br><span class="line">                <span class="comment">#获取本轮子密钥</span></span><br><span class="line">                key_y=run_key[<span class="number">15</span>-j]</span><br><span class="line"></span><br><span class="line">                <span class="comment">#异或</span></span><br><span class="line">                code_r= self._codeyihuo(code_r,key_y)</span><br><span class="line"></span><br><span class="line">                <span class="comment">#S盒代替/选择</span></span><br><span class="line">                code_r= self._functionS(code_r)</span><br><span class="line"></span><br><span class="line">                <span class="comment">#P转换</span></span><br><span class="line">                code_r= self._functionP(code_r)</span><br><span class="line"></span><br><span class="line">                <span class="comment">#异或</span></span><br><span class="line">                code_r= self._codeyihuo(code_l,code_r)</span><br><span class="line"></span><br><span class="line">                run_code+=code_r</span><br><span class="line">            num+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">#32互换</span></span><br><span class="line">            code_r=run_code[<span class="number">32</span>:<span class="number">64</span>]</span><br><span class="line">            code_l=run_code[<span class="number">0</span>:<span class="number">32</span>]</span><br><span class="line">            run_code=code_r+code_l</span><br><span class="line"></span><br><span class="line">            <span class="comment">#将二进制转换为16进制、逆初始置换</span></span><br><span class="line">            output+=self._functionCodeChange(run_code)</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">    <span class="comment">#获取子密钥</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_getkey</span>(<span class="params">self,key,key_len</span>):</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#将密钥转换为二进制</span></span><br><span class="line">        code_key=self._functionCharToA(key,key_len)</span><br><span class="line"></span><br><span class="line">        a=[<span class="string">&#x27;&#x27;</span>]*<span class="number">16</span></span><br><span class="line">        real_len=(key_len/<span class="number">16</span>)*<span class="number">16</span>+<span class="number">16</span> <span class="keyword">if</span> key_len%<span class="number">16</span>!=<span class="number">0</span> <span class="keyword">else</span> key_len</span><br><span class="line"></span><br><span class="line">        b=[<span class="string">&#x27;&#x27;</span>]*(real_len/<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(real_len/<span class="number">16</span>):</span><br><span class="line">            b[i]=a[:]</span><br><span class="line">        num=<span class="number">0</span></span><br><span class="line">        trun_len=<span class="number">4</span>*key_len</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,trun_len,<span class="number">64</span>):</span><br><span class="line">            run_key=code_key[i:i+<span class="number">64</span>]</span><br><span class="line">            run_key= self._keyfirstchange(run_key)</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">                key_l=run_key[<span class="number">0</span>:<span class="number">28</span>]</span><br><span class="line">                key_r=run_key[<span class="number">28</span>:<span class="number">56</span>]</span><br><span class="line">                key_l=key_l[d[j]:<span class="number">28</span>]+key_l[<span class="number">0</span>:d[j]]</span><br><span class="line">                key_r=key_r[d[j]:<span class="number">28</span>]+key_r[<span class="number">0</span>:d[j]]</span><br><span class="line">                run_key=key_l+key_r</span><br><span class="line">                key_y= self._functionKeySecondChange(run_key)</span><br><span class="line">                b[num][j]=key_y[:]</span><br><span class="line">            num+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> b    </span><br><span class="line"></span><br><span class="line">    <span class="comment">#异或                                 </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_codeyihuo</span>(<span class="params">self,code,key</span>):</span></span><br><span class="line">        code_len=<span class="built_in">len</span>(key)</span><br><span class="line">        return_list=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(code_len):</span><br><span class="line">            <span class="keyword">if</span> code[i]==key[i]:</span><br><span class="line">                return_list+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                return_list+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> return_list</span><br><span class="line"></span><br><span class="line">    <span class="comment">#密文或明文初始置换                                     </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_codefirstchange</span>(<span class="params">self,code</span>):</span></span><br><span class="line">        changed_code=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            changed_code+=code[ip[i]-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> changed_code</span><br><span class="line"></span><br><span class="line">    <span class="comment">#密钥初始置换</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_keyfirstchange</span> (<span class="params">self,key</span>):</span></span><br><span class="line">        changed_key=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">56</span>):</span><br><span class="line">            changed_key+=key[pc1[i]-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> changed_key</span><br><span class="line"></span><br><span class="line">    <span class="comment">#逆初始置换</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_functionCodeChange</span>(<span class="params">self, code</span>):</span></span><br><span class="line">        return_list=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            <span class="built_in">list</span>=<span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                <span class="built_in">list</span>+=code[ip_1[i*<span class="number">4</span>+j]-<span class="number">1</span>]</span><br><span class="line">            return_list+=<span class="string">&quot;%x&quot;</span> %<span class="built_in">int</span>(<span class="built_in">list</span>,<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> return_list</span><br><span class="line"></span><br><span class="line">    <span class="comment">#扩展置换    </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_functionE</span>(<span class="params">self,code</span>):</span></span><br><span class="line">        return_list=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">            return_list+=code[e[i]-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> return_list        </span><br><span class="line"></span><br><span class="line">    <span class="comment">#置换P    </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_functionP</span>(<span class="params">self,code</span>):</span></span><br><span class="line">        return_list=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            return_list+=code[p[i]-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> return_list</span><br><span class="line"></span><br><span class="line">    <span class="comment">#S盒代替选择置换    </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_functionS</span>(<span class="params">self, key</span>):</span></span><br><span class="line">        return_list=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            row=<span class="built_in">int</span>( <span class="built_in">str</span>(key[i*<span class="number">6</span>])+<span class="built_in">str</span>(key[i*<span class="number">6</span>+<span class="number">5</span>]),<span class="number">2</span>)</span><br><span class="line">            raw=<span class="built_in">int</span>(<span class="built_in">str</span>( key[i*<span class="number">6</span>+<span class="number">1</span>])+<span class="built_in">str</span>(key[i*<span class="number">6</span>+<span class="number">2</span>])+<span class="built_in">str</span>(key[i*<span class="number">6</span>+<span class="number">3</span>])+<span class="built_in">str</span>(key[i*<span class="number">6</span>+<span class="number">4</span>]),<span class="number">2</span>)</span><br><span class="line">            return_list+=self._functionTos(s[i][row][raw],<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> return_list</span><br><span class="line"></span><br><span class="line">    <span class="comment">#密钥置换选择2</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_functionKeySecondChange</span>(<span class="params">self,key</span>):</span></span><br><span class="line">        return_list=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">            return_list+=key[pc2[i]-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> return_list</span><br><span class="line"></span><br><span class="line">    <span class="comment">#将十六进制转换为二进制字符串</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_functionCharToA</span>(<span class="params">self,code,lens</span>):</span></span><br><span class="line">        return_code=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        lens=lens%<span class="number">16</span></span><br><span class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> code:</span><br><span class="line">            code_ord=<span class="built_in">int</span>(key,<span class="number">16</span>)</span><br><span class="line">            return_code+=self._functionTos(code_ord,<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> lens!=<span class="number">0</span>:</span><br><span class="line">            return_code+=<span class="string">&#x27;0&#x27;</span>*(<span class="number">16</span>-lens)*<span class="number">4</span></span><br><span class="line">        <span class="keyword">return</span> return_code</span><br><span class="line"></span><br><span class="line">    <span class="comment">#二进制转换</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_functionTos</span>(<span class="params">self,o,lens</span>):</span></span><br><span class="line">        return_code=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(lens):</span><br><span class="line">            return_code=<span class="built_in">str</span>(o&gt;&gt;i &amp;<span class="number">1</span>)+return_code</span><br><span class="line">        <span class="keyword">return</span> return_code</span><br><span class="line"></span><br><span class="line"><span class="comment">#将unicode字符转换为16进制</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tohex</span>(<span class="params">string</span>):</span></span><br><span class="line">    return_string=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string:</span><br><span class="line">        return_string+=<span class="string">&quot;%02x&quot;</span>%<span class="built_in">ord</span>(i)</span><br><span class="line">    <span class="keyword">return</span> return_string</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tounicode</span>(<span class="params">string</span>):</span></span><br><span class="line">    return_string=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    string_len=<span class="built_in">len</span>(string)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,string_len,<span class="number">2</span>):</span><br><span class="line">        return_string+=<span class="built_in">chr</span>(<span class="built_in">int</span>(string[i:i+<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line">    <span class="keyword">return</span> return_string</span><br><span class="line"></span><br><span class="line"><span class="comment">#入口函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">desdecode</span>(<span class="params">from_code,key</span>):</span></span><br><span class="line">    key=tohex(key)cd</span><br><span class="line"></span><br><span class="line">    des=DES()</span><br><span class="line"></span><br><span class="line">    key_len=<span class="built_in">len</span>(key)</span><br><span class="line">    string_len=<span class="built_in">len</span>(from_code)</span><br><span class="line">    <span class="keyword">if</span> string_len%<span class="number">16</span>!=<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> string_len&lt;<span class="number">1</span> <span class="keyword">or</span> key_len&lt;<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    key_code= des.decode(from_code,key,key_len,string_len)</span><br><span class="line">    <span class="keyword">return</span> tounicode(key_code)</span><br><span class="line"></span><br><span class="line"><span class="comment">#测试</span></span><br><span class="line"><span class="keyword">if</span> __name__  == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span> desdecode(<span class="string">&#x27;84148584371a6a1fe99e1da0ce1e34649b88ed15098e8aa4b8eb0bf24885c658&#x27;</span>,<span class="string">&#x27;0f1571c947刘&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>我们可以在系统中打开文档进行代码的查看，在Linux系统命令行中输入vi desjiemi.py,系统显示出来的代码图[vi jiemi.py]如：</p>
<ul>
<li>
<p>cd cryptography/DES</p>
<img src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210412233309396.png" alt="image-20210412233309396" style="zoom: 50%;" />
</li>
<li>
<p>vi desjiemi.py</p>
<img src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210412233330010.png" alt="image-20210412233330010" style="zoom:33%;" />
</li>
</ul>
</li>
</ol>
<h4 id="执行程序，并使用DES密码进行加密和解密">执行程序，并使用DES密码进行加密和解密</h4>
<ol>
<li>
<p>进行测试程序是否能实现DES密码加密</p>
<p>首先我们来执行DES.py来验证加密过程，输入以下命令行：</p>
<ul>
<li>python2 desjiami.py</li>
</ul>
<p>为了方便，我们已经在代码中将所要加密的明文规定好了，输入命令回车运行以后，它会对输入的明文进行加密，得到如下结果：；</p>
<img src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210412233437832.png" alt="image-20210412233437832" style="zoom:50%;" />
</li>
<li>
<p>进行测试程序是否能实现DES密码解密，得到所要的明文：</p>
<p>为了方便，我们已经在代码中将所要解密的密文规定好了，输入命令回车运行以后，它会对输入的密文进行解密，得到如下结果：</p>
<img src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210412233516588.png" alt="image-20210412233516588" style="zoom:50%;" />
</li>
</ol>
<h3 id="3DES-编码实验">3DES 编码实验</h3>
<ol>
<li>
<p>我们可以在系统中打开文档进行代码的查看，在Linux系统命令行中输入vi 3DES.py，系统显示出来的代码图[vi 3DES.py]如：</p>
<ul>
<li>cd cryptography/3DES</li>
<li>vi 3DES.py</li>
</ul>
<img src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210412234052028.png" alt="image-20210412234052028" style="zoom:33%;" />
<p>可以看到代码只是调用了库.</p>
<p>查看完毕后，我们点击Esc键并输入ZZ退出查看。</p>
<p>之后我们对这段代码进行验证。</p>
</li>
<li>
<p>执行程序</p>
<p>首先我们来执行3DES.py来验证加密过程，由于我们直接引用了Crypto函数库中的Cipher模块进行相应的加密运算，并且为了方便美观我们已经事先在代码中将密钥key和明文b2bpwd进行了声明赋值，所以我们可以直接输入以下命令行：</p>
<ul>
<li>python2 3DES.py</li>
</ul>
<img src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210412234143193.png" alt="image-20210412234143193" style="zoom:50%;" />
</li>
</ol>
<h3 id="DES-加解密实验">DES 加解密实验</h3>
<h4 id="查看DES密码算法的源码">查看DES密码算法的源码</h4>
<ol>
<li>
<p>主函数2.c</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*-------------------------------------------------------</span></span><br><span class="line"><span class="comment">      Data Encryption Standard  56位密钥加密64位数据</span></span><br><span class="line"><span class="comment">--------------------------------------------------------*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bool.h&quot;</span>   <span class="comment">// 位处理 </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;tables.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BitsCopy</span><span class="params">(<span class="keyword">bool</span> *DatOut,<span class="keyword">bool</span> *DatIn,<span class="keyword">int</span> Len)</span></span>;  <span class="comment">// 数组复制 </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ByteToBit</span><span class="params">(<span class="keyword">bool</span> *DatOut,<span class="keyword">char</span> *DatIn,<span class="keyword">int</span> Num)</span></span>; <span class="comment">// 字节到位 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BitToByte</span><span class="params">(<span class="keyword">char</span> *DatOut,<span class="keyword">bool</span> *DatIn,<span class="keyword">int</span> Num)</span></span>; <span class="comment">// 位到字节</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BitToHex</span><span class="params">(<span class="keyword">char</span> *DatOut,<span class="keyword">bool</span> *DatIn,<span class="keyword">int</span> Num)</span></span>;  <span class="comment">// 二进制到十六进制 64位 to 4*16字符</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">HexToBit</span><span class="params">(<span class="keyword">bool</span> *DatOut,<span class="keyword">char</span> *DatIn,<span class="keyword">int</span> Num)</span></span>;  <span class="comment">// 十六进制到二进制 </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TablePermute</span><span class="params">(<span class="keyword">bool</span> *DatOut,<span class="keyword">bool</span> *DatIn,<span class="keyword">const</span> <span class="keyword">char</span> *Table,<span class="keyword">int</span> Num)</span></span>; <span class="comment">// 位表置换函数 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">LoopMove</span><span class="params">(<span class="keyword">bool</span> *DatIn,<span class="keyword">int</span> Len,<span class="keyword">int</span> Num)</span></span>;     <span class="comment">// 循环左移 Len长度 Num移动位数 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Xor</span><span class="params">(<span class="keyword">bool</span> *DatA,<span class="keyword">bool</span> *DatB,<span class="keyword">int</span> Num)</span></span>;         <span class="comment">// 异或函数 </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">S_Change</span><span class="params">(<span class="keyword">bool</span> DatOut[<span class="number">32</span>],<span class="keyword">bool</span> DatIn[<span class="number">48</span>])</span></span>;   <span class="comment">// S盒变换 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">F_Change</span><span class="params">(<span class="keyword">bool</span> DatIn[<span class="number">32</span>],<span class="keyword">bool</span> DatKi[<span class="number">48</span>])</span></span>;    <span class="comment">// F函数                                  </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SetKey</span><span class="params">(<span class="keyword">char</span> KeyIn[<span class="number">8</span>])</span></span>;                         <span class="comment">// 设置密钥</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PlayDes</span><span class="params">(<span class="keyword">char</span> MesOut[<span class="number">8</span>],<span class="keyword">char</span> MesIn[<span class="number">8</span>])</span></span>;       <span class="comment">// 执行DES加密</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">KickDes</span><span class="params">(<span class="keyword">char</span> MesOut[<span class="number">8</span>],<span class="keyword">char</span> MesIn[<span class="number">8</span>])</span></span>;             <span class="comment">// 执行DES解密 </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>; </span><br><span class="line">    <span class="keyword">char</span> MesHex[<span class="number">16</span>]=&#123;<span class="number">0</span>&#125;;         <span class="comment">// 16个字符数组用于存放 64位16进制的密文</span></span><br><span class="line">    <span class="keyword">char</span> MyKey[<span class="number">9</span>]=&#123;<span class="number">0</span>&#125;;           <span class="comment">// 初始密钥 8字节*8</span></span><br><span class="line">    <span class="keyword">char</span> YourKey[<span class="number">9</span>]=&#123;<span class="number">0</span>&#125;;         <span class="comment">// 输入的解密密钥 8字节*8</span></span><br><span class="line">    <span class="keyword">char</span> MyMessage[<span class="number">9</span>]=&#123;<span class="number">0</span>&#125;;       <span class="comment">// 初始明文 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*-----------------------------------------------*/</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Welcome! Please input your Message(64 bit):\n&quot;</span>);</span><br><span class="line"><span class="comment">//    gets(MyMessage);            // 明文</span></span><br><span class="line">    <span class="keyword">while</span>((fgets(MyMessage,<span class="keyword">sizeof</span>(MyMessage),<span class="built_in">stdin</span>))==<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strlen</span>(MyMessage)!=<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(MyMessage);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Please input your Secret Key:\n&quot;</span>);</span><br><span class="line"><span class="comment">//    gets(MyKey);                // 密钥</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>((fgets(MyKey,<span class="keyword">sizeof</span>(MyKey),<span class="built_in">stdin</span>))!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strlen</span>(MyKey)!=<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(MyKey);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>)；</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(MyKey[i]!=<span class="string">&#x27;\0&#x27;</span>)        <span class="comment">// 计算密钥长度</span></span><br><span class="line">    &#123;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(i!=<span class="number">8</span>)                  <span class="comment">// 不是8 提示错误</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Please input a correct Secret Key!\n&quot;</span>);</span><br><span class="line"><span class="comment">//        gets(MyKey);</span></span><br><span class="line">        <span class="keyword">while</span>((fgets(MyKey,<span class="keyword">sizeof</span>(MyKey),<span class="built_in">stdin</span>))!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strlen</span>(MyKey)!=<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(MyKey);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>)；</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">        i=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(MyKey[i]!=<span class="string">&#x27;\0&#x27;</span>)    <span class="comment">// 再次检测</span></span><br><span class="line">        &#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    SetKey(MyKey);               <span class="comment">// 设置密钥 得到子密钥Ki</span></span><br><span class="line"></span><br><span class="line">    PlayDes(MesHex,MyMessage);   <span class="comment">// 执行DES加密</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Your Message is Encrypted!:\n&quot;</span>);  <span class="comment">// 信息已加密</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">16</span>;i++)           </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c &quot;</span>,MesHex[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Please input your Secret Key to Deciphering:\n&quot;</span>);  <span class="comment">// 请输入密钥以解密</span></span><br><span class="line"><span class="comment">//    gets(YourKey);                                         // 得到密钥</span></span><br><span class="line"><span class="comment">//    fgets(YourKey,8,stdin);</span></span><br><span class="line"></span><br><span class="line">     <span class="keyword">while</span>((fgets(YourKey,<span class="keyword">sizeof</span>(YourKey),<span class="built_in">stdin</span>))!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strlen</span>(YourKey)!=<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(YourKey);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>)；</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    SetKey(YourKey);                                       <span class="comment">// 设置密钥</span></span><br><span class="line"></span><br><span class="line">    KickDes(MyMessage,MesHex);                     <span class="comment">// 解密输出到MyMessage</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Deciphering Over !!:\n&quot;</span>);                     <span class="comment">// 解密结束</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c &quot;</span>,MyMessage[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*------------------------------------------------*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*-------------------------------</span></span><br><span class="line"><span class="comment"> 把DatIn开始的长度位Len位的二进制</span></span><br><span class="line"><span class="comment"> 复制到DatOut后</span></span><br><span class="line"><span class="comment">--------------------------------*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BitsCopy</span><span class="params">(<span class="keyword">bool</span> *DatOut,<span class="keyword">bool</span> *DatIn,<span class="keyword">int</span> Len)</span>     <span class="comment">// 数组复制 OK </span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;Len;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        DatOut[i]=DatIn[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*-------------------------------</span></span><br><span class="line"><span class="comment"> 字节转换成位函数 </span></span><br><span class="line"><span class="comment"> 每8次换一个字节 每次向右移一位</span></span><br><span class="line"><span class="comment"> 和1与取最后一位 共64位 </span></span><br><span class="line"><span class="comment">--------------------------------*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ByteToBit</span><span class="params">(<span class="keyword">bool</span> *DatOut,<span class="keyword">char</span> *DatIn,<span class="keyword">int</span> Num)</span>       <span class="comment">// OK</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;Num;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        DatOut[i]=(DatIn[i/<span class="number">8</span>]&gt;&gt;(i%<span class="number">8</span>))&amp;<span class="number">0x01</span>;   </span><br><span class="line">    &#125;                                       </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*-------------------------------</span></span><br><span class="line"><span class="comment"> 位转换成字节函数</span></span><br><span class="line"><span class="comment"> 字节数组每8次移一位</span></span><br><span class="line"><span class="comment"> 位每次向左移 与上一次或   </span></span><br><span class="line"><span class="comment">---------------------------------*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BitToByte</span><span class="params">(<span class="keyword">char</span> *DatOut,<span class="keyword">bool</span> *DatIn,<span class="keyword">int</span> Num)</span>        <span class="comment">// OK</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;(Num/<span class="number">8</span>);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        DatOut[i]=<span class="number">0</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;Num;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        DatOut[i/<span class="number">8</span>]|=DatIn[i]&lt;&lt;(i%<span class="number">8</span>);    </span><br><span class="line">    &#125;        </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*----------------------------------</span></span><br><span class="line"><span class="comment"> 二进制密文转换为十六进制</span></span><br><span class="line"><span class="comment"> 需要16个字符表示</span></span><br><span class="line"><span class="comment">-----------------------------------*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BitToHex</span><span class="params">(<span class="keyword">char</span> *DatOut,<span class="keyword">bool</span> *DatIn,<span class="keyword">int</span> Num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;Num/<span class="number">4</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        DatOut[i]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;Num/<span class="number">4</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        DatOut[i] = DatIn[i*<span class="number">4</span>]+(DatIn[i*<span class="number">4</span>+<span class="number">1</span>]&lt;&lt;<span class="number">1</span>)</span><br><span class="line">                    +(DatIn[i*<span class="number">4</span>+<span class="number">2</span>]&lt;&lt;<span class="number">2</span>)+(DatIn[i*<span class="number">4</span>+<span class="number">3</span>]&lt;&lt;<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">if</span>((DatOut[i]%<span class="number">16</span>)&gt;<span class="number">9</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            DatOut[i]=DatOut[i]%<span class="number">16</span>+<span class="string">&#x27;7&#x27;</span>;       <span class="comment">//  余数大于9时处理 10-15 to A-F</span></span><br><span class="line">        &#125;                                     <span class="comment">//  输出字符 </span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            DatOut[i]=DatOut[i]%<span class="number">16</span>+<span class="string">&#x27;0&#x27;</span>;       <span class="comment">//  输出字符       </span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*---------------------------------------------</span></span><br><span class="line"><span class="comment"> 十六进制字符转二进制</span></span><br><span class="line"><span class="comment">----------------------------------------------*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">HexToBit</span><span class="params">(<span class="keyword">bool</span> *DatOut,<span class="keyword">char</span> *DatIn,<span class="keyword">int</span> Num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;                        <span class="comment">// 字符型输入 </span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;Num;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>((DatIn[i/<span class="number">4</span>])&gt;<span class="string">&#x27;9&#x27;</span>)         <span class="comment">//  大于9 </span></span><br><span class="line">        &#123;</span><br><span class="line">            DatOut[i]=((DatIn[i/<span class="number">4</span>]-<span class="string">&#x27;7&#x27;</span>)&gt;&gt;(i%<span class="number">4</span>))&amp;<span class="number">0x01</span>;               </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            DatOut[i]=((DatIn[i/<span class="number">4</span>]-<span class="string">&#x27;0&#x27;</span>)&gt;&gt;(i%<span class="number">4</span>))&amp;<span class="number">0x01</span>;     </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 表置换函数  OK</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TablePermute</span><span class="params">(<span class="keyword">bool</span> *DatOut,<span class="keyword">bool</span> *DatIn,<span class="keyword">const</span> <span class="keyword">char</span> *Table,<span class="keyword">int</span> Num)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">bool</span> Temp[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;Num;i++)                <span class="comment">// Num为置换的长度 </span></span><br><span class="line">    &#123;</span><br><span class="line">        Temp[i]=DatIn[Table[i]<span class="number">-1</span>];  <span class="comment">// 原来的数据按对应的表上的位置排列 </span></span><br><span class="line">    &#125;</span><br><span class="line">    BitsCopy(DatOut,Temp,Num);       <span class="comment">// 把缓存Temp的值输出 </span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 子密钥的移位</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">LoopMove</span><span class="params">(<span class="keyword">bool</span> *DatIn,<span class="keyword">int</span> Len,<span class="keyword">int</span> Num)</span> <span class="comment">// 循环左移 Len数据长度 Num移动位数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">bool</span> Temp[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;    <span class="comment">// 缓存   OK</span></span><br><span class="line">    BitsCopy(Temp,DatIn,Num);       <span class="comment">// 将数据最左边的Num位(被移出去的)存入Temp </span></span><br><span class="line">    BitsCopy(DatIn,DatIn+Num,Len-Num); <span class="comment">// 将数据左边开始的第Num移入原来的空间</span></span><br><span class="line">    BitsCopy(DatIn+Len-Num,Temp,Num);  <span class="comment">// 将缓存中移出去的数据加到最右边 </span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 按位异或</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Xor</span><span class="params">(<span class="keyword">bool</span> *DatA,<span class="keyword">bool</span> *DatB,<span class="keyword">int</span> Num)</span>           <span class="comment">// 异或函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;Num;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        DatA[i]=DatA[i]^DatB[i];                  <span class="comment">// 异或 </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 输入48位 输出32位 与Ri异或</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">S_Change</span><span class="params">(<span class="keyword">bool</span> DatOut[<span class="number">32</span>],<span class="keyword">bool</span> DatIn[<span class="number">48</span>])</span>     <span class="comment">// S盒变换</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,X,Y;                                    <span class="comment">// i为8个S盒 </span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>,Y=<span class="number">0</span>,X=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++,DatIn+=<span class="number">6</span>,DatOut+=<span class="number">4</span>)   <span class="comment">// 每执行一次,输入数据偏移6位 </span></span><br><span class="line">    &#123;                                              <span class="comment">// 每执行一次,输出数据偏移4位</span></span><br><span class="line">        Y=(DatIn[<span class="number">0</span>]&lt;&lt;<span class="number">1</span>)+DatIn[<span class="number">5</span>];                          <span class="comment">// af代表第几行</span></span><br><span class="line">        X=(DatIn[<span class="number">1</span>]&lt;&lt;<span class="number">3</span>)+(DatIn[<span class="number">2</span>]&lt;&lt;<span class="number">2</span>)+(DatIn[<span class="number">3</span>]&lt;&lt;<span class="number">1</span>)+DatIn[<span class="number">4</span>]; <span class="comment">// bcde代表第几列</span></span><br><span class="line">        ByteToBit(DatOut,&amp;S_Box[i][Y][X],<span class="number">4</span>);      <span class="comment">// 把找到的点数据换为二进制    </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// F函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">F_Change</span><span class="params">(<span class="keyword">bool</span> DatIn[<span class="number">32</span>],<span class="keyword">bool</span> DatKi[<span class="number">48</span>])</span>       <span class="comment">// F函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">bool</span> MiR[<span class="number">48</span>]=&#123;<span class="number">0</span>&#125;;             <span class="comment">// 输入32位通过E选位变为48位</span></span><br><span class="line">    TablePermute(MiR,DatIn,E_Table,<span class="number">48</span>); </span><br><span class="line">    Xor(MiR,DatKi,<span class="number">48</span>);                   <span class="comment">// 和子密钥异或</span></span><br><span class="line">    S_Change(DatIn,MiR);                 <span class="comment">// S盒变换</span></span><br><span class="line">    TablePermute(DatIn,DatIn,P_Table,<span class="number">32</span>);   <span class="comment">// P置换后输出</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SetKey</span><span class="params">(<span class="keyword">char</span> KeyIn[<span class="number">8</span>])</span>               <span class="comment">// 设置密钥 获取子密钥Ki </span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">bool</span> KeyBit[<span class="number">64</span>]=&#123;<span class="number">0</span>&#125;;                <span class="comment">// 密钥二进制存储空间 </span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">bool</span> *KiL=&amp;KeyBit[<span class="number">0</span>],*KiR=&amp;KeyBit[<span class="number">28</span>];  <span class="comment">// 前28,后28共56</span></span><br><span class="line">    ByteToBit(KeyBit,KeyIn,<span class="number">64</span>);                    <span class="comment">// 把密钥转为二进制存入KeyBit </span></span><br><span class="line">    TablePermute(KeyBit,KeyBit,PC1_Table,<span class="number">56</span>);      <span class="comment">// PC1表置换 56次</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">16</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        LoopMove(KiL,<span class="number">28</span>,Move_Table[i]);       <span class="comment">// 前28位左移 </span></span><br><span class="line">        LoopMove(KiR,<span class="number">28</span>,Move_Table[i]);          <span class="comment">// 后28位左移 </span></span><br><span class="line">         TablePermute(SubKey[i],KeyBit,PC2_Table,<span class="number">48</span>); </span><br><span class="line">         <span class="comment">// 二维数组 SubKey[i]为每一行起始地址 </span></span><br><span class="line">         <span class="comment">// 每移一次位进行PC2置换得 Ki 48位 </span></span><br><span class="line">    &#125;        </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PlayDes</span><span class="params">(<span class="keyword">char</span> MesOut[<span class="number">8</span>],<span class="keyword">char</span> MesIn[<span class="number">8</span>])</span>  <span class="comment">// 执行DES加密</span></span></span><br><span class="line"><span class="function"></span>&#123;                                           <span class="comment">// 字节输入 Bin运算 Hex输出 </span></span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">bool</span> MesBit[<span class="number">64</span>]=&#123;<span class="number">0</span>&#125;;        <span class="comment">// 明文二进制存储空间 64位</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">bool</span> Temp[<span class="number">32</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">bool</span> *MiL=&amp;MesBit[<span class="number">0</span>],*MiR=&amp;MesBit[<span class="number">32</span>]; <span class="comment">// 前32位 后32位 </span></span><br><span class="line">    ByteToBit(MesBit,MesIn,<span class="number">64</span>);                 <span class="comment">// 把明文换成二进制存入MesBit</span></span><br><span class="line">    TablePermute(MesBit,MesBit,IP_Table,<span class="number">64</span>);    <span class="comment">// IP置换 </span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">16</span>;i++)                       <span class="comment">// 迭代16次 </span></span><br><span class="line">    &#123;</span><br><span class="line">        BitsCopy(Temp,MiR,<span class="number">32</span>);            <span class="comment">// 临时存储</span></span><br><span class="line">        F_Change(MiR,SubKey[i]);           <span class="comment">// F函数变换</span></span><br><span class="line">        Xor(MiR,MiL,<span class="number">32</span>);                  <span class="comment">// 得到Ri </span></span><br><span class="line">        BitsCopy(MiL,Temp,<span class="number">32</span>);            <span class="comment">// 得到Li </span></span><br><span class="line">    &#125;                    </span><br><span class="line">    TablePermute(MesBit,MesBit,IPR_Table,<span class="number">64</span>);</span><br><span class="line">    BitToHex(MesOut,MesBit,<span class="number">64</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">KickDes</span><span class="params">(<span class="keyword">char</span> MesOut[<span class="number">8</span>],<span class="keyword">char</span> MesIn[<span class="number">8</span>])</span>       <span class="comment">// 执行DES解密</span></span></span><br><span class="line"><span class="function"></span>&#123;                                                <span class="comment">// Hex输入 Bin运算 字节输出 </span></span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">bool</span> MesBit[<span class="number">64</span>]=&#123;<span class="number">0</span>&#125;;        <span class="comment">// 密文二进制存储空间 64位</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">bool</span> Temp[<span class="number">32</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">bool</span> *MiL=&amp;MesBit[<span class="number">0</span>],*MiR=&amp;MesBit[<span class="number">32</span>]; <span class="comment">// 前32位 后32位</span></span><br><span class="line">    HexToBit(MesBit,MesIn,<span class="number">64</span>);                 <span class="comment">// 把密文换成二进制存入MesBit</span></span><br><span class="line">    TablePermute(MesBit,MesBit,IP_Table,<span class="number">64</span>);    <span class="comment">// IP置换 </span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">15</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">    &#123;</span><br><span class="line">        BitsCopy(Temp,MiL,<span class="number">32</span>);</span><br><span class="line">        F_Change(MiL,SubKey[i]);</span><br><span class="line">        Xor(MiL,MiR,<span class="number">32</span>);</span><br><span class="line">        BitsCopy(MiR,Temp,<span class="number">32</span>);</span><br><span class="line">    &#125;    </span><br><span class="line">    TablePermute(MesBit,MesBit,IPR_Table,<span class="number">64</span>);</span><br><span class="line">    BitToByte(MesOut,MesBit,<span class="number">64</span>);        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>自定义头文件函数（置换表S盒）tables.h</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">/</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _TABLES_H_    <span class="comment">// 防重复编译 </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _TABLES_H_  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdbool.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 对明文执行IP置换得到L0,R0 （L左32位,R右32位）               [明文操作]</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> IP_Table[<span class="number">64</span>]=&#123;             </span><br><span class="line">    <span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>, <span class="number">2</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line">    <span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>, <span class="number">6</span>,<span class="number">64</span>,<span class="number">56</span>,<span class="number">48</span>,<span class="number">40</span>,<span class="number">32</span>,<span class="number">24</span>,<span class="number">16</span>, <span class="number">8</span>,</span><br><span class="line">    <span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>, <span class="number">9</span>, <span class="number">1</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>, <span class="number">3</span>,</span><br><span class="line">    <span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>, <span class="number">5</span>,<span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>, <span class="number">7</span> </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对迭代后的L16,R16执行IP逆置换,输出密文</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> IPR_Table[<span class="number">64</span>]=&#123;              </span><br><span class="line">    <span class="number">40</span>, <span class="number">8</span>,<span class="number">48</span>,<span class="number">16</span>,<span class="number">56</span>,<span class="number">24</span>,<span class="number">64</span>,<span class="number">32</span>,<span class="number">39</span>, <span class="number">7</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">55</span>,<span class="number">23</span>,<span class="number">63</span>,<span class="number">31</span>,</span><br><span class="line">    <span class="number">38</span>, <span class="number">6</span>,<span class="number">46</span>,<span class="number">14</span>,<span class="number">54</span>,<span class="number">22</span>,<span class="number">62</span>,<span class="number">30</span>,<span class="number">37</span>, <span class="number">5</span>,<span class="number">45</span>,<span class="number">13</span>,<span class="number">53</span>,<span class="number">21</span>,<span class="number">61</span>,<span class="number">29</span>,</span><br><span class="line">    <span class="number">36</span>, <span class="number">4</span>,<span class="number">44</span>,<span class="number">12</span>,<span class="number">52</span>,<span class="number">20</span>,<span class="number">60</span>,<span class="number">28</span>,<span class="number">35</span>, <span class="number">3</span>,<span class="number">43</span>,<span class="number">11</span>,<span class="number">51</span>,<span class="number">19</span>,<span class="number">59</span>,<span class="number">27</span>,</span><br><span class="line">    <span class="number">34</span>, <span class="number">2</span>,<span class="number">42</span>,<span class="number">10</span>,<span class="number">50</span>,<span class="number">18</span>,<span class="number">58</span>,<span class="number">26</span>,<span class="number">33</span>, <span class="number">1</span>,<span class="number">41</span>, <span class="number">9</span>,<span class="number">49</span>,<span class="number">17</span>,<span class="number">57</span>,<span class="number">25</span>    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*--------------------------- 迭代法则 ----------------------------*/</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">// F函数,32位的R0进行E变换,扩为48位输出 (R1~R16)        [备用A]  [明文操作] </span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">char</span> E_Table[<span class="number">48</span>]=&#123;</span><br><span class="line">    <span class="number">32</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>,</span><br><span class="line">    <span class="number">8</span>, <span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,</span><br><span class="line">    <span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>,<span class="number">25</span>,</span><br><span class="line">    <span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">32</span>, <span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子密钥K(i)的获取 密钥为K 抛弃第6,16,24,32,40,48,64位          [密钥操作] </span></span><br><span class="line"><span class="comment">// 用PC1选位 分为 前28位C0,后28位D0 两部分  </span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">char</span> PC1_Table[<span class="number">56</span>]=&#123;</span><br><span class="line">    <span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>, <span class="number">9</span>, <span class="number">1</span>,<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,</span><br><span class="line">    <span class="number">10</span>, <span class="number">2</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>, <span class="number">3</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,</span><br><span class="line">    <span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>, <span class="number">7</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,</span><br><span class="line">    <span class="number">14</span>, <span class="number">6</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>, <span class="number">5</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>, <span class="number">4</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对C0,D0分别进行左移,共16次,左移位数与下面对应                 [密钥操作]</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">char</span> Move_Table[<span class="number">16</span>]=&#123;</span><br><span class="line">    <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// C1,D1为第一次左移后得到,进行PC2选位,得到48位输出K1   [备用B]   [密钥操作]     </span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">char</span> PC2_Table[<span class="number">48</span>]=&#123;</span><br><span class="line">    <span class="number">14</span>,<span class="number">17</span>,<span class="number">11</span>,<span class="number">24</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>,<span class="number">28</span>,<span class="number">15</span>, <span class="number">6</span>,<span class="number">21</span>,<span class="number">10</span>,</span><br><span class="line">    <span class="number">23</span>,<span class="number">19</span>,<span class="number">12</span>, <span class="number">4</span>,<span class="number">26</span>, <span class="number">8</span>,<span class="number">16</span>, <span class="number">7</span>,<span class="number">27</span>,<span class="number">20</span>,<span class="number">13</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">41</span>,<span class="number">52</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">47</span>,<span class="number">55</span>,<span class="number">30</span>,<span class="number">40</span>,<span class="number">51</span>,<span class="number">34</span>,<span class="number">33</span>,<span class="number">48</span>,</span><br><span class="line">    <span class="number">44</span>,<span class="number">49</span>,<span class="number">39</span>,<span class="number">56</span>,<span class="number">34</span>,<span class="number">53</span>,<span class="number">46</span>,<span class="number">42</span>,<span class="number">50</span>,<span class="number">36</span>,<span class="number">29</span>,<span class="number">32</span>    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*------------- F函数 备用A和备用B 异或 得到48位输出 ---------------*/</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">// 异或后的结果48位分为8组,每组6位,作为8个S盒的输入             [组合操作] </span></span><br><span class="line"><span class="comment">// S盒以6位作为输入(8组),4位作为输出(4*(8组)=32位)</span></span><br><span class="line"><span class="comment">// S工作原理 假设输入为A=abcdef ,则bcde所代表的数是0-15之间的</span></span><br><span class="line"><span class="comment">// 一个数记为 X=bcde ,af代表的是0-3之间的一个数,记为 Y=af </span></span><br><span class="line"><span class="comment">// 在S1的X列,Y行找到一个数Value,它在0-15之间,可以用二进制表示</span></span><br><span class="line"><span class="comment">// 所以为4bit (共32位)  </span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">char</span> S_Box[<span class="number">8</span>][<span class="number">4</span>][<span class="number">16</span>]=&#123;</span><br><span class="line">    <span class="comment">//S1</span></span><br><span class="line">    <span class="number">14</span>, <span class="number">4</span>,<span class="number">13</span>, <span class="number">1</span>, <span class="number">2</span>,<span class="number">15</span>,<span class="number">11</span>, <span class="number">8</span>, <span class="number">3</span>,<span class="number">10</span>, <span class="number">6</span>,<span class="number">12</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">7</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">15</span>, <span class="number">7</span>, <span class="number">4</span>,<span class="number">14</span>, <span class="number">2</span>,<span class="number">13</span>, <span class="number">1</span>,<span class="number">10</span>, <span class="number">6</span>,<span class="number">12</span>,<span class="number">11</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line">    <span class="number">4</span>, <span class="number">1</span>,<span class="number">14</span>, <span class="number">8</span>,<span class="number">13</span>, <span class="number">6</span>, <span class="number">2</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">3</span>,<span class="number">10</span>, <span class="number">5</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">15</span>,<span class="number">12</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>,<span class="number">11</span>, <span class="number">3</span>,<span class="number">14</span>,<span class="number">10</span>, <span class="number">0</span>, <span class="number">6</span>,<span class="number">13</span>,</span><br><span class="line">    <span class="comment">//S2</span></span><br><span class="line">    <span class="number">15</span>, <span class="number">1</span>, <span class="number">8</span>,<span class="number">14</span>, <span class="number">6</span>,<span class="number">11</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">2</span>,<span class="number">13</span>,<span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>,<span class="number">10</span>,</span><br><span class="line">    <span class="number">3</span>,<span class="number">13</span>, <span class="number">4</span>, <span class="number">7</span>,<span class="number">15</span>, <span class="number">2</span>, <span class="number">8</span>,<span class="number">14</span>,<span class="number">12</span>, <span class="number">0</span>, <span class="number">1</span>,<span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>,<span class="number">11</span>, <span class="number">5</span>,</span><br><span class="line">    <span class="number">0</span>,<span class="number">14</span>, <span class="number">7</span>,<span class="number">11</span>,<span class="number">10</span>, <span class="number">4</span>,<span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>,<span class="number">12</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>,<span class="number">15</span>,</span><br><span class="line">    <span class="number">13</span>, <span class="number">8</span>,<span class="number">10</span>, <span class="number">1</span>, <span class="number">3</span>,<span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>,<span class="number">11</span>, <span class="number">6</span>, <span class="number">7</span>,<span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>,<span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">    <span class="comment">//S3</span></span><br><span class="line">    <span class="number">10</span>, <span class="number">0</span>, <span class="number">9</span>,<span class="number">14</span>, <span class="number">6</span>, <span class="number">3</span>,<span class="number">15</span>, <span class="number">5</span>, <span class="number">1</span>,<span class="number">13</span>,<span class="number">12</span>, <span class="number">7</span>,<span class="number">11</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>,</span><br><span class="line">    <span class="number">13</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>,<span class="number">10</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">15</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">13</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>,<span class="number">15</span>, <span class="number">3</span>, <span class="number">0</span>,<span class="number">11</span>, <span class="number">1</span>, <span class="number">2</span>,<span class="number">12</span>, <span class="number">5</span>,<span class="number">10</span>,<span class="number">14</span>, <span class="number">7</span>,</span><br><span class="line">    <span class="number">1</span>,<span class="number">10</span>,<span class="number">13</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">4</span>,<span class="number">15</span>,<span class="number">14</span>, <span class="number">3</span>,<span class="number">11</span>, <span class="number">5</span>, <span class="number">2</span>,<span class="number">12</span>,</span><br><span class="line">    <span class="comment">//S4</span></span><br><span class="line">    <span class="number">7</span>,<span class="number">13</span>,<span class="number">14</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>,<span class="number">10</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>, <span class="number">4</span>,<span class="number">15</span>,</span><br><span class="line">    <span class="number">13</span>, <span class="number">8</span>,<span class="number">11</span>, <span class="number">5</span>, <span class="number">6</span>,<span class="number">15</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">2</span>,<span class="number">12</span>, <span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">    <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>,<span class="number">12</span>,<span class="number">11</span>, <span class="number">7</span>,<span class="number">13</span>,<span class="number">15</span>, <span class="number">1</span>, <span class="number">3</span>,<span class="number">14</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>,</span><br><span class="line">    <span class="number">3</span>,<span class="number">15</span>, <span class="number">0</span>, <span class="number">6</span>,<span class="number">10</span>, <span class="number">1</span>,<span class="number">13</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>, <span class="number">7</span>, <span class="number">2</span>,<span class="number">14</span>,</span><br><span class="line">    <span class="comment">//S5</span></span><br><span class="line">    <span class="number">2</span>,<span class="number">12</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">7</span>,<span class="number">10</span>,<span class="number">11</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>,<span class="number">15</span>,<span class="number">13</span>, <span class="number">0</span>,<span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">    <span class="number">14</span>,<span class="number">11</span>, <span class="number">2</span>,<span class="number">12</span>, <span class="number">4</span>, <span class="number">7</span>,<span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">0</span>,<span class="number">15</span>,<span class="number">10</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line">    <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">13</span>, <span class="number">7</span>, <span class="number">8</span>,<span class="number">15</span>, <span class="number">9</span>,<span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">0</span>,<span class="number">14</span>,</span><br><span class="line">    <span class="number">11</span>, <span class="number">8</span>,<span class="number">12</span>, <span class="number">7</span>, <span class="number">1</span>,<span class="number">14</span>, <span class="number">2</span>,<span class="number">13</span>, <span class="number">6</span>,<span class="number">15</span>, <span class="number">0</span>, <span class="number">9</span>,<span class="number">10</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span>,</span><br><span class="line">    <span class="comment">//S6</span></span><br><span class="line">    <span class="number">12</span>, <span class="number">1</span>,<span class="number">10</span>,<span class="number">15</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>,<span class="number">13</span>, <span class="number">3</span>, <span class="number">4</span>,<span class="number">14</span>, <span class="number">7</span>, <span class="number">5</span>,<span class="number">11</span>,</span><br><span class="line">    <span class="number">10</span>,<span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>,<span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>,<span class="number">13</span>,<span class="number">14</span>, <span class="number">0</span>,<span class="number">11</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line">    <span class="number">9</span>,<span class="number">14</span>,<span class="number">15</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>,<span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">4</span>,<span class="number">10</span>, <span class="number">1</span>,<span class="number">13</span>,<span class="number">11</span>, <span class="number">6</span>,</span><br><span class="line">    <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>,<span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">14</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">8</span>,<span class="number">13</span>,</span><br><span class="line">    <span class="comment">//S7</span></span><br><span class="line">    <span class="number">4</span>,<span class="number">11</span>, <span class="number">2</span>,<span class="number">14</span>,<span class="number">15</span>, <span class="number">0</span>, <span class="number">8</span>,<span class="number">13</span>, <span class="number">3</span>,<span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>,<span class="number">10</span>, <span class="number">6</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">13</span>, <span class="number">0</span>,<span class="number">11</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>, <span class="number">3</span>, <span class="number">5</span>,<span class="number">12</span>, <span class="number">2</span>,<span class="number">15</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line">    <span class="number">1</span>, <span class="number">4</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">15</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">6</span>,<span class="number">11</span>,<span class="number">13</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">4</span>,<span class="number">10</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">0</span>,<span class="number">15</span>,<span class="number">14</span>, <span class="number">2</span>, <span class="number">3</span>,<span class="number">12</span>,</span><br><span class="line">    <span class="comment">//S8</span></span><br><span class="line">    <span class="number">13</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">6</span>,<span class="number">15</span>,<span class="number">11</span>, <span class="number">1</span>,<span class="number">10</span>, <span class="number">9</span>, <span class="number">3</span>,<span class="number">14</span>, <span class="number">5</span>, <span class="number">0</span>,<span class="number">12</span>, <span class="number">7</span>,</span><br><span class="line">    <span class="number">1</span>,<span class="number">15</span>,<span class="number">13</span>, <span class="number">8</span>,<span class="number">10</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>,<span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>,<span class="number">11</span>, <span class="number">0</span>,<span class="number">14</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">7</span>,<span class="number">11</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">9</span>,<span class="number">12</span>,<span class="number">14</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">6</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">15</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>,</span><br><span class="line">    <span class="number">2</span>, <span class="number">1</span>,<span class="number">14</span>, <span class="number">7</span>, <span class="number">4</span>,<span class="number">10</span>, <span class="number">8</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">12</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>,<span class="number">11</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// F函数 最后第二步,对S盒输出的32进行P置换                     [组合操作]</span></span><br><span class="line"><span class="comment">// 输出的值参与一次迭代:</span></span><br><span class="line"><span class="comment">// L(i)=R(i-1)</span></span><br><span class="line"><span class="comment">// R(i)=L(i-1)^f(R(i-1),K(i)) 异或 </span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">char</span> P_Table[<span class="number">32</span>]=&#123;</span><br><span class="line">    <span class="number">16</span>, <span class="number">7</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">29</span>,<span class="number">12</span>,<span class="number">28</span>,<span class="number">17</span>, <span class="number">1</span>,<span class="number">15</span>,<span class="number">23</span>,<span class="number">26</span>, <span class="number">5</span>,<span class="number">18</span>,<span class="number">31</span>,<span class="number">10</span>,</span><br><span class="line">    <span class="number">2</span>, <span class="number">8</span>,<span class="number">24</span>,<span class="number">14</span>,<span class="number">32</span>,<span class="number">27</span>, <span class="number">3</span>, <span class="number">9</span>,<span class="number">19</span>,<span class="number">13</span>,<span class="number">30</span>, <span class="number">6</span>,<span class="number">22</span>,<span class="number">11</span>, <span class="number">4</span>,<span class="number">25</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 16个子密钥K(1~16) </span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">bool</span> SubKey[<span class="number">16</span>][<span class="number">48</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>自定义头文件函数bool.h</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __BOOL_H__</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __BOOL_H__</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="literal">false</span> = <span class="number">0</span>,</span><br><span class="line">        <span class="literal">true</span>  = <span class="number">1</span></span><br><span class="line">    &#125;<span class="keyword">bool</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="运行程序">运行程序</h4>
<p>我们可以在系统中打开文档进行代码的查看，在Linux系统命令行中输入vi 2.c，系统显示出来的代码图[vi 2.c]如：</p>
<ul>
<li>cd cryptography/Passwordapplicationcourse/des/</li>
<li>vi 2.c</li>
</ul>
<img src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210412234704103.png" alt="image-20210412234704103" style="zoom:33%;" />
<p>查看完毕后，我们点击Esc键并输入ZZ退出查看。</p>
<p>之后我们对这段代码进行验证：</p>
<p>输入clear进行清屏，之后输入以下代码查看到目录下有三个文件，分别是2.c（主函数），bool.h（自定义布尔函数），tables.h（S盒），我们按照以下指令进行代码的运行：</p>
<ul>
<li>ls</li>
<li>gcc bool.h</li>
<li>gcc tables.h</li>
<li>gcc 2.c -o 2</li>
<li>./2</li>
</ul>
<img src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210412234755229.png" alt="image-20210412234755229" style="zoom: 50%;" />
<p>此时主函数2.c就开始在linux系统下进行运行了，之后我们输入我们想要进行加密的八位明文和八位密钥进行加密，进行加密完成后再重新输入八位密钥来进行解密测试，验证试验是否成功；</p>
<ul>
<li>hongyaaa</li>
<li>12345678</li>
<li>12345678</li>
</ul>
<p>实验代码运行结果图如下：</p>
   <img src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210412234819055.png" alt="image-20210412234819055" style="zoom:50%;" />
<h2 id="四-实验总结分析">四. 实验总结分析</h2>
<p>本次实验在理论学习和演示实验的基础上, 阅读了DES和3DES的源码的实现.</p>
<h2 id="五-实验思考题">五. 实验思考题</h2>
<ul>
<li>
<p>des</p>
<img src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210412233624890.png" alt="image-20210412233624890" style="zoom:33%;" />
<img src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210412233634755.png" alt="image-20210412233634755" style="zoom:33%;" />
</li>
<li>
<p>3des</p>
<img src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210412234210837.png" alt="image-20210412234210837" style="zoom:33%;" />
<img src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210412234220120.png" alt="image-20210412234220120" style="zoom:33%;" /></li>
</ul>
</article><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/qwq_circle2.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">qwqbot</div><div class="author-info__description">CS-ACM-MUSIC-REANGDING-MOVIE</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">48</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">24</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pwqbot"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83"><span class="toc-text">一. 实验环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9"><span class="toc-text">二. 实验内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4"><span class="toc-text">三. 实验步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DES%E7%BC%96%E7%A0%81%E5%AE%9E%E9%AA%8C"><span class="toc-text">DES编码实验</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8BDES%E5%AF%86%E7%A0%81%E7%9A%84%E6%BA%90%E7%A0%81"><span class="toc-text">查看DES密码的源码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E7%A8%8B%E5%BA%8F%EF%BC%8C%E5%B9%B6%E4%BD%BF%E7%94%A8DES%E5%AF%86%E7%A0%81%E8%BF%9B%E8%A1%8C%E5%8A%A0%E5%AF%86%E5%92%8C%E8%A7%A3%E5%AF%86"><span class="toc-text">执行程序，并使用DES密码进行加密和解密</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3DES-%E7%BC%96%E7%A0%81%E5%AE%9E%E9%AA%8C"><span class="toc-text">3DES 编码实验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DES-%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AE%9E%E9%AA%8C"><span class="toc-text">DES 加解密实验</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8BDES%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E7%9A%84%E6%BA%90%E7%A0%81"><span class="toc-text">查看DES密码算法的源码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E7%A8%8B%E5%BA%8F"><span class="toc-text">运行程序</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E5%AE%9E%E9%AA%8C%E6%80%BB%E7%BB%93%E5%88%86%E6%9E%90"><span class="toc-text">四. 实验总结分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-%E5%AE%9E%E9%AA%8C%E6%80%9D%E8%80%83%E9%A2%98"><span class="toc-text">五. 实验思考题</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background: #D5F3F4"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By qwqbot</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', '', 'katex-wrap')
  })
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>