<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>人类一团散沙 BY U3d - 游戏项目实践期末项目报告 | qwqbot</title><meta name="author" content="qwqbot"><meta name="copyright" content="qwqbot"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="这是课程期末报告. 完整的项目在 https:&#x2F;&#x2F;github.com&#x2F;pwqbot&#x2F;HumanSlouchLoose-Unity3d 里   人类一团散沙 Human Slouch Loose En 1.项目简介 游戏灵感源于某日失眠, 莫名想起以前刮台风发洪水的时候,人会跳到洪水里, 手牵着手用肉身挡住水流……人类真是种可爱的生物. 于是《人类一团散沙》诞生了---玩家可以在其中搭建人墙,">
<meta property="og:type" content="article">
<meta property="og:title" content="人类一团散沙 BY U3d - 游戏项目实践期末项目报告">
<meta property="og:url" content="http://qwqbot.com/CS0804n/Game-Go/Unity/CS0804n/Game%20Go/Unity/Human/index.html">
<meta property="og:site_name" content="qwqbot">
<meta property="og:description" content="这是课程期末报告. 完整的项目在 https:&#x2F;&#x2F;github.com&#x2F;pwqbot&#x2F;HumanSlouchLoose-Unity3d 里   人类一团散沙 Human Slouch Loose En 1.项目简介 游戏灵感源于某日失眠, 莫名想起以前刮台风发洪水的时候,人会跳到洪水里, 手牵着手用肉身挡住水流……人类真是种可爱的生物. 于是《人类一团散沙》诞生了---玩家可以在其中搭建人墙,">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ding-typora.oss-cn-beijing.aliyuncs.com/img/RIOPY_RIOPY.jpg">
<meta property="article:published_time" content="2021-06-27T10:01:40.715Z">
<meta property="article:modified_time" content="2021-09-20T10:58:32.553Z">
<meta property="article:author" content="qwqbot">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ding-typora.oss-cn-beijing.aliyuncs.com/img/RIOPY_RIOPY.jpg"><link rel="shortcut icon" href="/img/qwq_circle2.jpg"><link rel="canonical" href="http://qwqbot.com/CS0804n/Game-Go/Unity/CS0804n/Game%20Go/Unity/Human/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="manifest" href="/pwa/manifest.json"/><link rel="apple-touch-icon" sizes="180x180" href="/pwa/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/pwa/32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/pwa/16.png"/><link rel="mask-icon" href="/pwa/safari-pinned-tab.svg" color="#5bbad5"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-09-20 18:58:32'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="/img/qwq_circle2.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">84</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">29</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">29</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://ding-typora.oss-cn-beijing.aliyuncs.com/img/RIOPY_RIOPY.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">qwqbot</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">人类一团散沙 BY U3d - 游戏项目实践期末项目报告</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-27T10:01:40.715Z" title="发表于 2021-06-27 18:01:40">2021-06-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-09-20T10:58:32.553Z" title="更新于 2021-09-20 18:58:32">2021-09-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CS0804n/">CS0804n</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CS0804n/Game-Go/">Game Go</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CS0804n/Game-Go/Unity/">Unity</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>这是课程期末报告.</p>
<p>完整的项目在 https://github.com/pwqbot/HumanSlouchLoose-Unity3d 里</p>
</blockquote>
 <center style="font-size:60px">人类一团散沙 Human Slouch Loose</center> En
<h1>1.项目简介</h1>
<p>游戏灵感源于某日失眠, 莫名想起以前刮台风发洪水的时候,人会跳到洪水里, 手牵着手用肉身挡住水流……人类真是种可爱的生物.</p>
<p>于是《人类一团散沙》诞生了---玩家可以在其中搭建人墙, 用角色的身体挡住,击打一些游戏道具, 如小球, 车辆等, 在此基础上设计有趣的关卡.</p>
<p>遇到的第一个难点是角色的身体控制, 我希望在角色控制上给予玩家尽可能多的自由度, 模拟出真实的骨骼和关节效果, 可以让角色摆出任何想要的姿势.</p>
<p>第二个难点是交互方式的设计, 因为角色控制的自由度极高, 所以必须设计出符合直觉的交互方式才能实现玩家对角色的身体控制.</p>
<p>第三个难点是关卡的设计, 实现了高自由度的角色的控制之后, 要如何设计出有趣巧妙的关卡与角色进行交互, 从而能让玩家在游戏里自由发挥他们的想象力和创造力.</p>
<p>经过这段时间的努力, 一二两点已经实现的比较成功了, 只是游戏关卡目前还只设计了三关, 除了第一关是新手关卡之外, 后面两关都具有一定的创意和可玩性, 也实现了我最开始所构想的效果. 后续还需增加关卡的数量和复杂性, 让高自由度的身体控制发挥真正有趣的效果.</p>
<h1>2.游戏创意</h1>
<p>玩家可以以极高的自由度控制角色的身体, 角色不仅可以移动, 旋转, 而且其手臂, 腿脚, 头部等都可以拖拉到任何玩家想要的姿势上.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/clip_image002.jpg" alt="img" style="zoom:67%;" />
<p>在此高自由度身体控制的基础上, 玩家可以将角色以任何姿势吸附在地形上, 使角色扩展延展为地形道具的一部分. 再配合上精心设计的关卡道具, 既存在一定的难度, 需要玩家发挥自己的创意, 又十分有趣好玩.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/clip_image004.jpg" alt="img" style="zoom:67%;" />
<h1>3. 概要设计</h1>
<p>游戏的设计主要分为三块.</p>
<ol>
<li>
<p>操作设计</p>
<p>玩家如何控制角色.</p>
</li>
<li>
<p>关卡设计</p>
<p>主要是关卡模型的搭建和特殊道具.</p>
</li>
<li>
<p>美术/UI/音效设计</p>
<p>为ui和三个关卡都制作了简单好看的美术设计. 同时制作了基本的音效给予玩家反馈提示</p>
</li>
</ol>
<p>其中角色控制花了很多的时间, 一个是功能的实现, 另一个是交互的逻辑, 经历一个很长的尝试优化的过程.</p>
<p>关卡的设计主要来自莫名其妙的想法.</p>
<p>美术和UI的设计是希望能在简洁美观的基础上做一些小创新.</p>
<blockquote>
<p>使用的素材有 小人的3d模型, 天空盒以及音效.</p>
</blockquote>
<h1>4. 详细设计</h1>
<h2 id="1-操作设计">1. 操作设计</h2>
<h3 id="生成小人">生成小人</h3>
<p>点击右侧ui后再点击屏幕即可在对应位置产生一个小人.</p>
<h3 id="摄像机控制">摄像机控制</h3>
<ul>
<li>
<p>移动</p>
<p>WASD 前后左右 QE 上下</p>
</li>
<li>
<p>旋转</p>
<p>右键控制角度</p>
</li>
</ul>
<p>当左键选中小人的时候, WASD控制的是小人的位置. 此时按住右键即在选中小人的同时移动摄像机.</p>
<h3 id="小人控制">小人控制</h3>
<p>点击小人的躯干可以控制小人.</p>
<p>小人有两种控制模式, 按 G 可以互相切换</p>
<ul>
<li>
<p>移动模式</p>
<p>WASD前后左右, QE上下.</p>
<p>鼠标可以拖拽小人位置.</p>
</li>
<li>
<p>旋转模式</p>
<p>WASDQE可以控制小人绕三个轴的旋转.</p>
<p>鼠标可以控制旋转角度.</p>
</li>
</ul>
<p>除了对躯干的控制, 玩家还可以使用鼠标控制小人的手和脚的位置, 当手或者脚贴近地形或者其他小人的身体时会抓在上面.</p>
<ul>
<li>
<p>躯干控制</p>
<p>可以操控头部, 手臂和腿部. 用鼠标点击对应的部位并拖拽即可控制其关节角度.</p>
</li>
</ul>
<h2 id="2-关卡设计">2. 关卡设计</h2>
<h3 id="关卡1-KinderGarden">关卡1 : KinderGarden</h3>
<p>第一关是新手关卡, 主要在于熟悉游戏的操作</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/clip_image039.jpg" alt="img"  />
<p>小球从台阶上滚下, 玩家需要在拐角出搭建人墙挡住小球, 让小球掉到右边的烟囱中.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/clip_image041.jpg" alt="img" style="zoom:80%;" />
<p>除了在拐角处搭建之外, 还需要在烟囱和左边的地形之间连出人桥让球通过.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210627181253924.png" alt="image-20210627181253924" style="zoom: 25%;" />
<h3 id="关卡2-Spin-Crazy">关卡2 : Spin Crazy</h3>
<p>第二关叫做 “Spin Crazy”. 玩家可以把小人挂在旋转的杆子上.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/clip_image043.jpg" alt="img"  />
<p>小人旋转起来之后会击打小球, 目标是把球打过两个圆环.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/clip_image045.jpg" alt="img" style="zoom: 80%;" />
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/clip_image047.jpg" alt="img" style="zoom: 80%;" />
<h3 id="关卡3-Mathematician">关卡3 : Mathematician</h3>
<p>第三关名为 “Mathematician”, 灵感来自于经典的正态分布弹球实验.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/clip_image049.jpg" alt="img" style="zoom: 80%;" />
<p>众所周知小球经过这样的装置之后, 在下方的落点呈现出正态分布.</p>
<p>这关需要玩家用小人堵上某些杆子之间的空隙, 使得小球在下方的落点为两边多中间少的分布.</p>
<p>但胜利判定还未实装, 玩家可以先玩试试效果.</p>
<h2 id="3-UI-美术-音效">3. UI/美术/音效</h2>
<h3 id="UI">UI</h3>
<h4 id="开始界面">开始界面</h4>
<p>​     低对比度的纯色背景+渐变效果文字.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210627183954514.png" alt="image-20210627183954514" style="zoom: 25%;" />
<p>关卡选择界面</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210627184006553.png" alt="image-20210627184006553" style="zoom: 25%;" />
<p>​     #### 游戏UI</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/clip_image010.jpg" alt="img"  />
<p>游戏内的 UI 分为两个部分</p>
<h4 id="操作UI">操作UI</h4>
<p>第一部分是角色创建和控制的 UI, 分别位于屏幕的最左侧和最右侧.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210627184112805.png" alt="image-20210627184112805" style="zoom: 67%;" />
<p>当玩家点击White/Yellow/Black 三个按钮中的一个时, 下方会出现一个小勾, 提示玩家选中了该类型的角色, 接下来点击屏幕中的某个位置即可在对应的位置创建角色</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210627184133250.png" alt="image-20210627184133250" style="zoom: 67%;" />
<p>左侧的 MOVE/ROTATE 表示当前角色的控制模式. 点击按钮或者键盘上按下G键互相切换.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210627184213701.png" alt="image-20210627184213701" style="zoom: 55%;" />
<p>切换为ROTATE</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210627184230307.png" alt="image-20210627184230307" style="zoom:55%;" />
<h4 id="UI-2">UI</h4>
<p>第二部分是游戏开始和退出的UI.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210627184420818.png" alt="image-20210627184420818" style="zoom:67%;" />
<p>点击右下角的Start按钮, 游戏开始, 场景内生成小球, 并且角色状态发生改变(如受到重力控制等), Start 按钮变为 Restart 按钮.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210627184511093.png" alt="image-20210627184511093" style="zoom:67%;" />
<p>点击Restart 按钮, 游戏回到建造状态, 生成的小球小时, 但是之前已经建造好的角色仍会保留, 让玩家可以继续在上一次的建造基础上继续建造.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210627184524907.png" alt="image-20210627184524907" style="zoom:67%;" />
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210627184534761.png" alt="image-20210627184534761" style="zoom:67%;" />
<p>点击Restart后小球消失,玩家可以继续建造</p>
<p>右上角的Quit按钮点击之后可以回到开始界面.</p>
<h3 id="美术">美术</h3>
<h4 id="第一关-KinderGarden">第一关 : KinderGarden</h4>
<p>第一关使用了阴天的天空盒加上垂直雾效果.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210627183428007.png" alt="image-20210627183428007" style="zoom:25%;" />
<h4 id="第二关-Spin-Crazy">第二关 : Spin Crazy</h4>
<p>使用了银河的天空盒, 场景犹如漂浮在宇宙之中,</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/1631786289487.png" alt="1631786289487" style="zoom: 50%;" />
<p>给两个圆环加上了光环效果.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/1631786352574.png" alt="1631786352574" style="zoom: 50%;" />
<h4 id="第三关-Mathematician">第三关 : Mathematician</h4>
<p>第三关使用了半透明+雾+粉色场景, 少女心十足.</p>
<img src= "/img/loading.gif" data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/image-20210627183706661.png" alt="image-20210627183706661" style="zoom:25%;" />
<blockquote>
<p>除了天空盒和垂直雾的shader, 所有场景的创意和搭建和美术都是自己实现的.</p>
</blockquote>
<h3 id="音效">音效</h3>
<p>音效设计虽然简单但还是完成了基本的功能.</p>
<ol>
<li>
<p>玩家点击按钮会有音效提示</p>
</li>
<li>
<p>小球碰撞音效</p>
</li>
<li>
<p>当手或者脚靠近其他物体时会有音效提示吸附成功.</p>
</li>
<li>
<p>背景音乐</p>
<p>分别为三个关卡按照其美术效果选择了不同的背景音乐</p>
</li>
</ol>
<h1>5.编程实现</h1>
<h3 id="1-移动旋转控制">1. 移动旋转控制</h3>
<p>实现了键盘控制和鼠标拖拽</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.SceneManagement;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MoveCharacter</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Start is called before the first frame update</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">float</span> mzCoord;</span><br><span class="line">    <span class="keyword">private</span> Vector3 mOffset;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Transform moveObj;</span><br><span class="line">    <span class="keyword">public</span> Transform wangding;</span><br><span class="line">    <span class="keyword">public</span> Transform moveCamera;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">SerializeField</span>]</span><br><span class="line">    Vector3 tarScale1;</span><br><span class="line">    [<span class="meta">SerializeField</span>]</span><br><span class="line">    Vector3 tarScale2;</span><br><span class="line">    <span class="keyword">private</span> Rigidbody[] kids;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> state;</span><br><span class="line">    <span class="built_in">bool</span> notOnMouse = <span class="literal">true</span>;</span><br><span class="line">    <span class="built_in">float</span> tarRotateX = <span class="number">0f</span>;</span><br><span class="line">    <span class="built_in">float</span> tarRotateY = <span class="number">0f</span>;</span><br><span class="line">    [<span class="meta">SerializeField,Range(.1f,.3f)</span>]</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">float</span> sensitivityX = <span class="number">.1</span>f;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">SerializeField,Range(.1f,.3f)</span>]</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">float</span> sensitivityY = <span class="number">.1</span>f;</span><br><span class="line">    [<span class="meta">Range(.1f, 1f)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> speed = <span class="number">.2</span>f;</span><br><span class="line">    <span class="keyword">private</span> Vector3 oriPosition;</span><br><span class="line">    <span class="keyword">private</span> Quaternion oriRotation;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        oriRotation = transform.localRotation;</span><br><span class="line">        oriPosition = transform.localPosition;</span><br><span class="line">        wangding = transform.root;</span><br><span class="line">        moveCamera = GameObject.Find(<span class="string">&quot;Move Camera&quot;</span>).transform;</span><br><span class="line">        tarScale1 = transform.localScale * <span class="number">1f</span>;    </span><br><span class="line">        tarScale2 = transform.localScale;</span><br><span class="line">        kids = moveObj.GetComponentsInChildren&lt;Rigidbody&gt;();</span><br><span class="line">        state = <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">// Debug.Log(kids.Length);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Move</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(GameController.rotate)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(Input.GetKey(<span class="string">&quot;a&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Vector3 rotation = <span class="keyword">new</span> Vector3(<span class="number">0</span>,speed,<span class="number">0</span>);</span><br><span class="line">                moveObj.transform.Rotate(rotation);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(Input.GetKey(<span class="string">&quot;d&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Vector3 rotation = <span class="keyword">new</span> Vector3(<span class="number">0</span>,-speed,<span class="number">0</span>);</span><br><span class="line">                moveObj.transform.Rotate(rotation);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(Input.GetKey(<span class="string">&quot;w&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Vector3 rotation = <span class="keyword">new</span> Vector3(-speed,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">                moveObj.transform.Rotate(rotation);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(Input.GetKey(<span class="string">&quot;s&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Vector3 rotation = <span class="keyword">new</span> Vector3(speed,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">                moveObj.transform.Rotate(rotation);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(Input.GetKey(<span class="string">&quot;q&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Vector3 rotation = <span class="keyword">new</span> Vector3(<span class="number">0</span>,<span class="number">0</span>,speed);</span><br><span class="line">                moveObj.transform.Rotate(rotation);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(Input.GetKey(<span class="string">&quot;e&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Vector3 rotation = <span class="keyword">new</span> Vector3(<span class="number">0</span>,<span class="number">0</span>,-speed);</span><br><span class="line">                moveObj.transform.Rotate(rotation);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(Input.GetKey(<span class="string">&quot;a&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Vector3 rotation = -speed * moveCamera.right * Time.deltaTime * <span class="number">3f</span>;</span><br><span class="line">                moveObj.transform.Translate(rotation, Space.World);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(Input.GetKey(<span class="string">&quot;d&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Vector3 rotation = speed * moveCamera.right * Time.deltaTime * <span class="number">3f</span>;</span><br><span class="line">                moveObj.transform.Translate(rotation, Space.World);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(Input.GetKey(<span class="string">&quot;w&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Vector3 rotation = speed * moveCamera.forward * Time.deltaTime * <span class="number">3f</span>;</span><br><span class="line">                rotation.y = <span class="number">0</span>;</span><br><span class="line">                moveObj.transform.Translate(rotation, Space.World);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(Input.GetKey(<span class="string">&quot;s&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Vector3 rotation = -speed * moveCamera.forward * Time.deltaTime * <span class="number">3f</span>; </span><br><span class="line">                rotation.y = <span class="number">0</span>;</span><br><span class="line">                moveObj.transform.Translate(rotation, Space.World);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(Input.GetKey(<span class="string">&quot;q&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Vector3 rotation = -speed * moveCamera.up * Time.deltaTime * <span class="number">3f</span>;</span><br><span class="line">                moveObj.transform.Translate(rotation, Space.World);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(Input.GetKey(<span class="string">&quot;e&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Vector3 rotation = speed * moveCamera.up * Time.deltaTime * <span class="number">3f</span>;</span><br><span class="line">                moveObj.transform.Translate(rotation, Space.World);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnMouseDown</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="comment">// foreach(Rigidbody rb in kids)</span></span><br><span class="line">        <span class="comment">// &#123;</span></span><br><span class="line">        <span class="comment">//     rb.isKinematic = false;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        notOnMouse = <span class="literal">false</span>;</span><br><span class="line">        mzCoord = Camera.main.WorldToScreenPoint(moveObj.transform.position).z;</span><br><span class="line">        mOffset = moveObj.transform.position - GetMouseWorldPos();</span><br><span class="line">        FixedJoint[] fjoints = GetComponentsInChildren&lt;FixedJoint&gt;();</span><br><span class="line">        HingeJoint[] spjoints = GetComponentsInChildren&lt;HingeJoint&gt;();</span><br><span class="line">        <span class="keyword">foreach</span>(HingeJoint sp <span class="keyword">in</span> spjoints)</span><br><span class="line">        &#123;</span><br><span class="line">            Destroy(sp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">foreach</span>(FixedJoint sp <span class="keyword">in</span> fjoints)</span><br><span class="line">        &#123;</span><br><span class="line">            Destroy(sp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// mOffset = transform.position - GetMouseWorldPos();</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Vector3 <span class="title">GetMouseWorldPos</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Vector3 mousepoint = Input.mousePosition;</span><br><span class="line">        mousepoint.z = mzCoord;</span><br><span class="line">        <span class="keyword">return</span> Camera.main.ScreenToWorldPoint(mousepoint);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnMouseDrag</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="comment">// moveObj.transform.localScale = Vector3.Lerp(transform.localScale, tarScale1, Time.deltaTime);</span></span><br><span class="line">        <span class="keyword">if</span>(!GameController.rotate)</span><br><span class="line">            moveObj.transform.position = GetMouseWorldPos() + mOffset;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">        &#123;</span><br><span class="line">            tarRotateX += Input.GetAxis(<span class="string">&quot;Mouse X&quot;</span>) * sensitivityX / <span class="number">100f</span>;</span><br><span class="line">            tarRotateY -= Input.GetAxis(<span class="string">&quot;Mouse Y&quot;</span>) * sensitivityY / <span class="number">100f</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">// Quaternion tarRotation = Quaternion.Euler(tarRotateY,tarRotateX,0);  </span></span><br><span class="line">            Vector3 rotation = Vector3.zero;</span><br><span class="line">            rotation = Input.GetAxis(<span class="string">&quot;Mouse Y&quot;</span>) * <span class="number">3f</span> * moveCamera.right;</span><br><span class="line">            rotation -= Input.GetAxis(<span class="string">&quot;Mouse X&quot;</span>) * moveCamera.forward;</span><br><span class="line">            moveObj.Rotate(rotation, relativeTo:Space.World);</span><br><span class="line">            <span class="comment">// moveObj.transform.rotation = Quaternion.Slerp(transform.rotation, tarRotation, Time.deltaTime);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private void OnMouseEnter() &#123;</span></span><br><span class="line">    <span class="comment">//     transform.localScale = Vector3.Lerp(transform.localScale, tarScale1, Time.deltaTime);</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnMouseUp</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="comment">// foreach(Rigidbody rb in kids)</span></span><br><span class="line">        <span class="comment">// &#123;</span></span><br><span class="line">        <span class="comment">//     rb.isKinematic = true;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        notOnMouse = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-肢体控制">2.   肢体控制</h3>
<p>把鼠标输入转换为力矩.</p>
<p>为了让操作更简单. 拖拽肢体的时候只检测水平或者垂直一个方向的输入.</p>
<p>用了一个先进先出的队列实现, 检测最近五次鼠标在水平和垂直方向移动距离的累计值来选择检测x方向还是y方向的输入.</p>
<p>实现效果还是不错的, 切换起来很平滑.</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ForceControl</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Start is called before the first frame update</span></span><br><span class="line">    <span class="keyword">public</span> Transform moveCamera;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">float</span> mzCoord;</span><br><span class="line">    <span class="keyword">private</span> Vector3 mOffset;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Transform moveObj;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Rigidbody[] kids;</span><br><span class="line">    <span class="keyword">public</span> CharacterJoint[] joints;</span><br><span class="line">    <span class="keyword">public</span> Transform spin;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> SoftJointLimit[] joints2;</span><br><span class="line">    <span class="keyword">private</span> Rigidbody myRb;</span><br><span class="line">    <span class="built_in">bool</span> notOnMouse = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> mode = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">float</span> mx = <span class="number">0f</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">float</span> my = <span class="number">0f</span>;</span><br><span class="line">    <span class="keyword">private</span> Queue&lt;<span class="built_in">float</span>&gt; qx;</span><br><span class="line">    <span class="keyword">private</span> Queue&lt;<span class="built_in">float</span>&gt; qy;</span><br><span class="line">    <span class="keyword">private</span> Quaternion rotated;</span><br><span class="line">    <span class="keyword">private</span> Vector3 <span class="keyword">from</span>;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        spin = <span class="keyword">this</span>.transform.root;</span><br><span class="line">        rotated = <span class="keyword">new</span> Quaternion();</span><br><span class="line">        <span class="comment">// from = transform.rotation;</span></span><br><span class="line">        qx = <span class="keyword">new</span> Queue&lt;<span class="built_in">float</span>&gt;();</span><br><span class="line">        qy = <span class="keyword">new</span> Queue&lt;<span class="built_in">float</span>&gt;();</span><br><span class="line">        <span class="comment">// spin = GameObject.Find(&quot;spine_03&quot;).transform;</span></span><br><span class="line">        moveCamera = GameObject.Find(<span class="string">&quot;Move Camera&quot;</span>).transform;</span><br><span class="line">        <span class="comment">// kids = moveObj.GetComponentsInChildren&lt;Rigidbody&gt;();</span></span><br><span class="line">        kids = moveObj.GetComponentsInChildren&lt;Rigidbody&gt;();</span><br><span class="line">        joints = moveObj.GetComponentsInChildren&lt;CharacterJoint&gt;();</span><br><span class="line">        joints2 = <span class="keyword">new</span> SoftJointLimit[joints.Length * <span class="number">4</span>];</span><br><span class="line">        <span class="comment">// joints2 = (CharacterJoint [])joints.Clone();</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; joints.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            joints2[i * <span class="number">4</span>] = joints[i].lowTwistLimit;</span><br><span class="line">            joints2[i * <span class="number">4</span> + <span class="number">1</span>] = joints[i].highTwistLimit;</span><br><span class="line">            joints2[i * <span class="number">4</span> + <span class="number">2</span>] = joints[i].swing1Limit;</span><br><span class="line">            joints2[i * <span class="number">4</span> + <span class="number">3</span>] = joints[i].swing2Limit;</span><br><span class="line">        &#125;</span><br><span class="line">        myRb = moveObj.GetComponent&lt;Rigidbody&gt;();</span><br><span class="line">        <span class="comment">// Debug.Log(kids.Length);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Vector3 <span class="title">GetMouseWorldPos</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Vector3 mousepoint = Input.mousePosition;</span><br><span class="line">        mousepoint.z = mzCoord;</span><br><span class="line">        <span class="keyword">return</span> Camera.main.ScreenToWorldPoint(mousepoint);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Quaternion <span class="title">getJointRotation</span>(<span class="params">CharacterJoint joint</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Debug.Log(joint.connectedBody.transform.rotation.eulerAngles);</span><br><span class="line">        <span class="keyword">return</span>(Quaternion.FromToRotation(joint.axis, joint.connectedBody.transform.rotation.eulerAngles));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnMouseDown</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        GameController.state2 = <span class="literal">false</span>;</span><br><span class="line">        Debug.Log(<span class="string">&quot;down&quot;</span>);</span><br><span class="line">        <span class="comment">// CharacterJoint joint = ComponentExtensions.GetCopyOf(joint, this.GetComponent&lt;CharacterJoint&gt;());</span></span><br><span class="line">        <span class="comment">// from = joint.axis;</span></span><br><span class="line">        <span class="comment">// Debug.Log(getJointRotation(joint).eulerAngles);</span></span><br><span class="line">        FixedJoint[] fjoints = GetComponentsInChildren&lt;FixedJoint&gt;();</span><br><span class="line">        HingeJoint[] spjoints = GetComponentsInChildren&lt;HingeJoint&gt;();</span><br><span class="line">        <span class="keyword">foreach</span>(HingeJoint sp <span class="keyword">in</span> spjoints)</span><br><span class="line">        &#123;</span><br><span class="line">            Destroy(sp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">foreach</span>(FixedJoint sp <span class="keyword">in</span> fjoints)</span><br><span class="line">        &#123;</span><br><span class="line">            Destroy(sp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">foreach</span>(Rigidbody rb <span class="keyword">in</span> kids)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(rb.gameObject != <span class="keyword">this</span>.gameObject)</span><br><span class="line">            &#123;</span><br><span class="line">                rb.isKinematic = <span class="literal">false</span>;</span><br><span class="line">                <span class="comment">// ;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">foreach</span>(CharacterJoint jt <span class="keyword">in</span> joints)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(jt.gameObject == <span class="keyword">this</span>.gameObject)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="comment">// Quaternion angle = Quaternion.FromToRotation(jt.axis, jt.transform.rotation.eulerAngles);</span></span><br><span class="line">            <span class="keyword">var</span> njt = jt.lowTwistLimit;</span><br><span class="line">            <span class="comment">// Debug.Log(angle.eulerAngles);</span></span><br><span class="line">            <span class="comment">// njt.limit = rotated.eulerAngles.x;</span></span><br><span class="line">            <span class="comment">// jt.</span></span><br><span class="line">            njt.limit = <span class="number">0f</span>;</span><br><span class="line">            jt.lowTwistLimit = njt;</span><br><span class="line">            <span class="comment">// jt.enablePreprocessing = false;</span></span><br><span class="line">            jt.highTwistLimit = njt;</span><br><span class="line">            jt.swing1Limit = jt.swing2Limit = njt;</span><br><span class="line">        &#125;</span><br><span class="line">        myRb.isKinematic = <span class="literal">false</span>;</span><br><span class="line">        notOnMouse = <span class="literal">false</span>;</span><br><span class="line">        mzCoord = Camera.main.WorldToScreenPoint(moveObj.transform.position).z;</span><br><span class="line">        mOffset = moveObj.transform.position - GetMouseWorldPos();</span><br><span class="line">        <span class="comment">// mOffset = transform.position - GetMouseWorldPos();</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnMouseUp</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="comment">// rotated = Quaternion.FromToRotation(from.eulerAngles, transform.rotation.eulerAngles);</span></span><br><span class="line">        <span class="comment">// Debug.Log(rotated.eulerAngles);</span></span><br><span class="line">        GameController.state2 = <span class="literal">true</span>;</span><br><span class="line">        mx = my = <span class="number">0f</span>;</span><br><span class="line">        qx.Clear();</span><br><span class="line">        qy.Clear();</span><br><span class="line">        <span class="comment">// for(int i = 0; i &lt; joints.Length; i++)</span></span><br><span class="line">        <span class="comment">// &#123;</span></span><br><span class="line">        <span class="comment">//     joints[i].gameObject.GetComponent&lt;Rigidbody&gt;().isKinematic = true;</span></span><br><span class="line">        <span class="comment">//     CharacterJoint jt = joints[i];</span></span><br><span class="line">        <span class="comment">//     if(jt.gameObject == this.gameObject)</span></span><br><span class="line">        <span class="comment">//         continue;</span></span><br><span class="line">        <span class="comment">//     gameObject.AddComponent&lt;CharacterJoint&gt;();</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="keyword">foreach</span>(Rigidbody rb <span class="keyword">in</span> kids)</span><br><span class="line">        &#123;</span><br><span class="line">            rb.isKinematic = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; joints.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            CharacterJoint jt = joints[i];</span><br><span class="line"></span><br><span class="line">            jt.lowTwistLimit = joints2[i * <span class="number">4</span>];</span><br><span class="line">            jt.highTwistLimit = joints2[i * <span class="number">4</span> + <span class="number">1</span>];</span><br><span class="line">            jt.swing1Limit = joints2[i * <span class="number">4</span> + <span class="number">2</span>];</span><br><span class="line">            jt.swing2Limit = joints2[i * <span class="number">4</span> + <span class="number">3</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        myRb.isKinematic = <span class="literal">true</span>;</span><br><span class="line">        notOnMouse = <span class="literal">true</span>;</span><br><span class="line">        mode = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnMouseDrag</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="comment">// moveObj.transform.position = GetMouseWorldPos() + mOffset;</span></span><br><span class="line">        Vector3 forceDirection = Vector3.zero;</span><br><span class="line">        Rigidbody body = moveObj.GetComponent&lt;Rigidbody&gt;(); </span><br><span class="line">        <span class="built_in">float</span> mass = body.mass;</span><br><span class="line">        body.velocity = Vector3.zero;</span><br><span class="line">        body.angularVelocity = Vector3.zero;</span><br><span class="line">        <span class="built_in">float</span> x = Input.GetAxis(<span class="string">&quot;Mouse X&quot;</span>);</span><br><span class="line">        <span class="built_in">float</span> y = Input.GetAxis(<span class="string">&quot;Mouse Y&quot;</span>);</span><br><span class="line"></span><br><span class="line">        qx.Enqueue(Mathf.Abs(x));</span><br><span class="line">        qy.Enqueue(Mathf.Abs(y));</span><br><span class="line">        mx += Mathf.Abs(x);</span><br><span class="line">        my += Mathf.Abs(y);</span><br><span class="line">        <span class="keyword">if</span>(qx.Count &gt; <span class="number">10</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            mx -= qx.Dequeue();</span><br><span class="line">            my -= qy.Dequeue();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(mode == <span class="number">0</span> &amp;&amp; (Mathf.Abs(mx) &gt; <span class="number">2f</span> || Mathf.Abs(my) &gt; <span class="number">2f</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(Mathf.Abs(mx) &gt; <span class="number">2f</span>)</span><br><span class="line">                mode = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                mode = <span class="number">2</span>;</span><br><span class="line">            qx.Clear();</span><br><span class="line">            qy.Clear();</span><br><span class="line">            mx = my = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(mode == <span class="number">1</span> &amp;&amp; Mathf.Abs(my) &gt; Mathf.Abs(mx) + <span class="number">4f</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            mode = <span class="number">2</span>;</span><br><span class="line">            qx.Clear();</span><br><span class="line">            qy.Clear();</span><br><span class="line">            mx = my = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// mx = my = 0f;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(mode == <span class="number">2</span> &amp;&amp; Mathf.Abs(mx) &gt; Mathf.Abs(my) + <span class="number">4f</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            mode = <span class="number">1</span>;</span><br><span class="line">            qx.Clear();</span><br><span class="line">            qy.Clear();</span><br><span class="line">            mx = my = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// mx = my = 0f;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Debug.Log(mx);</span></span><br><span class="line">        <span class="comment">// Debug.Log(&quot;x:&quot; + x);</span></span><br><span class="line">        <span class="comment">// Debug.Log(&quot;y:&quot; + y);</span></span><br><span class="line">        <span class="keyword">if</span>(mode == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// forceDirection += Input.GetAxis(&quot;Mouse Y&quot;) * mass * 5f * moveCamera.forward;</span></span><br><span class="line">            Vector3 force = <span class="keyword">new</span> Vector3(<span class="number">0</span>,<span class="number">0</span>,Input.GetAxis(<span class="string">&quot;Mouse Y&quot;</span>) * <span class="number">50000f</span>);</span><br><span class="line">            force.y = force.x = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(transform.name == <span class="string">&quot;upperarm_r&quot;</span> || transform.name == <span class="string">&quot;thigh_r&quot;</span> || transform.name == <span class="string">&quot;calf_r&quot;</span> || transform.name == <span class="string">&quot;lowerarm_r&quot;</span>)</span><br><span class="line">                force *= <span class="number">-1</span>;</span><br><span class="line">            forceDirection += force;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// Debug.Log(moveCamera.forward);</span></span><br><span class="line">            <span class="comment">// Vector3 force = -1 * Input.GetAxis(&quot;Mouse X&quot;) * 50000f * (spin.forward - moveCamera.forward);</span></span><br><span class="line">            Vector3 rotation = Quaternion.FromToRotation(spin.right,moveCamera.forward).eulerAngles;</span><br><span class="line">            <span class="comment">// if(rotation.y &gt; 180)</span></span><br><span class="line">            <span class="comment">//     rotation.y -= 360;</span></span><br><span class="line">            <span class="comment">// Debug.Log(rotation.y);</span></span><br><span class="line">            <span class="keyword">if</span>(rotation.y &gt; <span class="number">90</span> &amp;&amp; rotation.y &lt; <span class="number">270</span>)</span><br><span class="line">                rotation.y -= <span class="number">90</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(rotation.y &lt; <span class="number">90</span>)</span><br><span class="line">                rotation.y = -rotation.y - <span class="number">90</span>;</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                rotation.y = -rotation.y + <span class="number">270</span>;</span><br><span class="line">            <span class="comment">// Debug.Log(rotation.y);</span></span><br><span class="line">            <span class="comment">// Debug.Log(spin.forward);</span></span><br><span class="line">            Vector3 force = <span class="keyword">new</span> Vector3(Input.GetAxis(<span class="string">&quot;Mouse X&quot;</span>) * <span class="number">50000f</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span>(transform.name == <span class="string">&quot;thigh_l&quot;</span> || transform.name == <span class="string">&quot;upperarm_l&quot;</span> || transform.name == <span class="string">&quot;head1&quot;</span>)</span><br><span class="line">                force *= <span class="number">-1</span>;</span><br><span class="line">            forceDirection += force;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// forceDirection.x = -Input.GetAxis(&quot;Mouse X&quot;) * 500f;</span></span><br><span class="line">            <span class="comment">// Debug.Log(transform.name);</span></span><br><span class="line">        <span class="comment">// forceDirection.z = Input.GetAxis(&quot;Mouse Y&quot;) * 500f;</span></span><br><span class="line">        <span class="comment">// Debug.Log(forceDirection);</span></span><br><span class="line">        <span class="comment">// Debug.Log(forceDirection);</span></span><br><span class="line">        <span class="comment">// forceDirection = moveObj.transform.forward * 1000f;</span></span><br><span class="line">        <span class="comment">// moveObj.GetComponent&lt;Rigidbody&gt;().AddRelativeForce(forceDirection,ForceMode.Impulse);</span></span><br><span class="line">        moveObj.GetComponent&lt;Rigidbody&gt;().AddRelativeTorque(forceDirection,ForceMode.VelocityChange);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private void OnMouseEnter() &#123;</span></span><br><span class="line">    <span class="comment">//     transform.localScale = Vector3.Lerp(transform.localScale, tarScale1, Time.deltaTime);</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-角色创建">3.   角色创建</h3>
<p>创建时让角色正对着当前摄像机.</p>
<p>第三关只在平面内创建.</p>
 <figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.UI;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.EventSystems;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.SceneManagement;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BuildManager</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">SerializeField</span>]</span><br><span class="line">    Transform  moveCamera;</span><br><span class="line">    <span class="keyword">public</span> ManData yellowMan;</span><br><span class="line">    <span class="keyword">public</span> ManData blackMan;</span><br><span class="line">    <span class="keyword">public</span> ManData whiteMan;</span><br><span class="line">    [<span class="meta">SerializeField</span>]</span><br><span class="line">    <span class="keyword">private</span> ManData selectedMan;</span><br><span class="line">    <span class="keyword">public</span> Transform sphere;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">SerializeField, Range(1,100)</span>]</span><br><span class="line">    <span class="built_in">float</span> createDepth;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> onSelecting = <span class="literal">false</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> Toggle yellowToggle;</span><br><span class="line">    <span class="keyword">public</span> Toggle blackToggle;</span><br><span class="line">    <span class="keyword">public</span> Toggle whiteToggle;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Toggle open;</span><br><span class="line">    <span class="comment">// Start is called before the first frame update</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(Input.GetKey(<span class="string">&quot;g&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            onSelecting = <span class="literal">false</span>;</span><br><span class="line">            open.isOn = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(Input.GetMouseButtonDown(<span class="number">0</span>) &amp;&amp; open != <span class="literal">null</span> &amp;&amp; open.isOn &amp;&amp; !GameController.gameStart)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(EventSystem.current.IsPointerOverGameObject())</span><br><span class="line">            &#123;</span><br><span class="line">                Debug.Log(<span class="string">&quot;111&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">            &#123;</span><br><span class="line">                Vector3 mousePoint = Input.mousePosition;</span><br><span class="line">                mousePoint = Camera.main.ScreenToWorldPoint(mousePoint);</span><br><span class="line">                <span class="keyword">if</span>(SceneManager.GetActiveScene().name == <span class="string">&quot;Mathematician&quot;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    Ray ray = Camera.main.ScreenPointToRay(Input.mousePosition);</span><br><span class="line">                    RaycastHit hit;</span><br><span class="line">                    <span class="built_in">bool</span> isCollider = Physics.Raycast(ray, <span class="keyword">out</span> hit);</span><br><span class="line">                    mousePoint = hit.point;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> </span><br><span class="line">                &#123;</span><br><span class="line">                    mousePoint.z = moveCamera.position.z;</span><br><span class="line">                    mousePoint = mousePoint + moveCamera.forward * createDepth;</span><br><span class="line">                    mousePoint.y -= <span class="number">1f</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                GameObject obj = Instantiate(selectedMan.manPrefab, mousePoint, moveCamera.rotation);</span><br><span class="line">                obj.transform.Rotate(<span class="keyword">new</span> Vector3(<span class="number">0</span>,<span class="number">180</span>,<span class="number">0</span>));</span><br><span class="line">                <span class="keyword">if</span>(SceneManager.GetActiveScene().name == <span class="string">&quot;Mathematician&quot;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    Vector3 position = obj.transform.position;</span><br><span class="line">                    position.z = sphere.position.z + <span class="number">2f</span>;</span><br><span class="line">                    obj.transform.position = position;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> </span><br><span class="line">                &#123;</span><br><span class="line">                    obj.transform.Rotate(<span class="keyword">new</span> Vector3(<span class="number">30</span>,<span class="number">0</span>,<span class="number">0</span>));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                onSelecting = <span class="literal">false</span>;</span><br><span class="line">                open.isOn = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DisableOnSelecting</span>(<span class="params"><span class="built_in">bool</span> isOn</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        onSelecting = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SelectYellow</span>(<span class="params"><span class="built_in">bool</span> isOn</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span>(yellowToggle.isOn)</span><br><span class="line">        &#123;</span><br><span class="line">            open = yellowToggle;</span><br><span class="line">            selectedMan = yellowMan;</span><br><span class="line">            onSelecting = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SelectBlack</span>(<span class="params"><span class="built_in">bool</span> isOn</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span>(blackToggle.isOn)</span><br><span class="line">        &#123;</span><br><span class="line">            open = blackToggle;</span><br><span class="line">            selectedMan = blackMan;</span><br><span class="line">            onSelecting = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SelectWhite</span>(<span class="params"><span class="built_in">bool</span> isOn</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span>(whiteToggle.isOn)</span><br><span class="line">        &#123;</span><br><span class="line">            open = whiteToggle;</span><br><span class="line">            selectedMan = whiteMan;</span><br><span class="line">            onSelecting = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="4-地形吸附">4.地形吸附</h3>
<p>碰撞检测, 在碰撞点添加关节.</p>
 <figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.SceneManagement;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AddJoint</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Start is called before the first frame update</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnCollisionEnter</span>(<span class="params">Collision other</span>)</span> &#123;</span><br><span class="line">        SpringJoint old = GetComponent&lt;SpringJoint&gt;();</span><br><span class="line">        <span class="keyword">if</span>(old != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Destroy(old);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(GameController.gameStart)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">// if(!GameController.state2)</span></span><br><span class="line">        <span class="comment">//     return;</span></span><br><span class="line">        <span class="keyword">if</span>(other.gameObject.transform.root == transform.root)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        Debug.Log(other.gameObject.name);</span><br><span class="line">        <span class="keyword">if</span>(SceneManager.GetActiveScene().name == <span class="string">&quot;SpinCrazy&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            FixedJoint joint = gameObject.AddComponent&lt;FixedJoint&gt;();</span><br><span class="line">            joint.connectedBody = other.rigidbody;</span><br><span class="line">            joint.breakForce = transform.root.gameObject.GetComponent&lt;SetCharacter&gt;().toughness * <span class="number">1000f</span>; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">        &#123;</span><br><span class="line">            HingeJoint joint = gameObject.AddComponent&lt;HingeJoint&gt;();</span><br><span class="line">            joint.connectedBody = other.rigidbody;</span><br><span class="line">            joint.breakForce = transform.root.gameObject.GetComponent&lt;SetCharacter&gt;().toughness * <span class="number">10f</span>; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// joint.limits = 0;</span></span><br><span class="line">        <span class="comment">// joint.maxDistance = .1f;</span></span><br><span class="line">        <span class="comment">// joint.minDistance = .2f;</span></span><br><span class="line">        <span class="comment">// joint.spring = 100f;    </span></span><br><span class="line">        <span class="comment">// joint.damper = 100f;</span></span><br><span class="line">        FindObjectOfType&lt;AudioManager&gt;().Play(<span class="string">&quot;Grab1&quot;</span>);</span><br><span class="line">        GameController.state2 = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="5-断肢效果-未实装">5.断肢效果(未实装)</h3>
<p>当关节断裂的时候设置Scale为0. 然后换上新的模型.</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Limb</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">SerializeField</span>] Limb[] childLimbs;</span><br><span class="line">    [<span class="meta">SerializeField</span>] GameObject limbPrefab;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Start is called before the first frame update</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GetHit</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span>(childLimbs.Length &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">foreach</span>(Limb limb <span class="keyword">in</span> childLimbs)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(limb != <span class="literal">null</span>)</span><br><span class="line">                    limb.GetHit();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        transform.localScale = Vector3.zero;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(limbPrefab != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            GameObject limb = Instantiate(limbPrefab,transform.position, transform.rotation);</span><br><span class="line">            Component copyComponent = gameObject.GetComponent&lt;Rigidbody&gt;();</span><br><span class="line">            UnityEditorInternal.ComponentUtility.CopyComponent(copyComponent);</span><br><span class="line">            UnityEditorInternal.ComponentUtility.PasteComponentAsNew(limb);</span><br><span class="line"></span><br><span class="line">            copyComponent = gameObject.GetComponent&lt;Collider&gt;();</span><br><span class="line">            UnityEditorInternal.ComponentUtility.CopyComponent(copyComponent);</span><br><span class="line">            UnityEditorInternal.ComponentUtility.PasteComponentAsNew(limb);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Destroy(<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">this</span>.GetComponent&lt;Rigidbody&gt;().isKinematic = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">OnJointBreak</span>(<span class="params"><span class="built_in">float</span> breakForce</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Debug.Log(<span class="string">&quot;A joint has just been broken!, force: &quot;</span> + breakForce);</span><br><span class="line">        GetHit();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="6-总控代码">6. 总控代码</h3>
<p>控制游戏开始结束, 检测鼠标选择等.</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.EventSystems;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.SceneManagement;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GameController</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> GameObject moveCamera;</span><br><span class="line">    <span class="keyword">public</span> GameObject mainCamera;</span><br><span class="line">    <span class="keyword">public</span> Transform spawn;</span><br><span class="line">    <span class="keyword">public</span> GameObject ball;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Transform selected;</span><br><span class="line">    [<span class="meta">SerializeField, Range(1,100)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> initSpeed;</span><br><span class="line">    <span class="keyword">public</span> GameObject button;</span><br><span class="line">    <span class="keyword">public</span> GameObject startButton;</span><br><span class="line">    <span class="keyword">public</span> GameObject restartButton;</span><br><span class="line">    <span class="keyword">public</span> GameObject sucesstext;</span><br><span class="line">    <span class="built_in">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> rotate = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> onCatch = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> gameStart = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> state2 = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">float</span> totalTime = <span class="number">0f</span>;</span><br><span class="line">    <span class="keyword">public</span> GameObject spin;</span><br><span class="line">    <span class="comment">// Start is called before the first frame update</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        moveCamera.SetActive(!flag);</span><br><span class="line">        mainCamera.SetActive(flag);</span><br><span class="line">        <span class="comment">// gameStart();</span></span><br><span class="line">        onCatch = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GameStart</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span>(spin != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            spin.GetComponent&lt;HingeJoint&gt;().useMotor = <span class="literal">true</span>;</span><br><span class="line">            spin.GetComponent&lt;Rigidbody&gt;().isKinematic = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Vector3 spawnPosition = spawn.position;</span><br><span class="line">        spawnPosition.z += <span class="number">1.5f</span>;</span><br><span class="line">        GameObject rball = Instantiate(ball, spawnPosition, spawn.rotation);</span><br><span class="line">        <span class="keyword">if</span>(SceneManager.GetActiveScene().name == <span class="string">&quot;SpinCrazy&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            rball.GetComponent&lt;Rigidbody&gt;().mass = <span class="number">1f</span>;</span><br><span class="line">            Debug.Log(<span class="string">&quot;123123123&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// rball.GetComponent&lt;Rigidbody&gt;().velocity = rball.transform.forward * initSpeed;</span></span><br><span class="line">        gameStart = <span class="literal">true</span>;</span><br><span class="line">        GameObject[] prefabs =  GameObject.FindGameObjectsWithTag(<span class="string">&quot;character&quot;</span>);</span><br><span class="line">        <span class="keyword">foreach</span>(GameObject gb <span class="keyword">in</span> prefabs)</span><br><span class="line">        &#123;</span><br><span class="line">            Rigidbody[] bodys =  gb.GetComponentsInChildren&lt;Rigidbody&gt;();</span><br><span class="line">            <span class="keyword">foreach</span>(Rigidbody rb <span class="keyword">in</span> bodys)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(rb.transform == rb.transform.root)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span>(rb.name == <span class="string">&quot;head1&quot;</span> &amp;&amp; SceneManager.GetActiveScene().name != <span class="string">&quot;SpinCrazy&quot;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    ConstantForce force =  rb.gameObject.AddComponent&lt;ConstantForce&gt;();</span><br><span class="line">                    <span class="keyword">if</span>(force != <span class="literal">null</span>)</span><br><span class="line">                        force.force = <span class="keyword">new</span> Vector3(<span class="number">0</span>,<span class="number">1600f</span>,<span class="number">0f</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                rb.useGravity = <span class="literal">true</span>;</span><br><span class="line">                rb.isKinematic = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        FindObjectOfType&lt;AudioManager&gt;().Play(<span class="string">&quot;ButtonUp&quot;</span>);</span><br><span class="line">        restartButton.SetActive(<span class="literal">true</span>);</span><br><span class="line">        startButton.SetActive(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GameRestart</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// SceneManager.LoadScene(SceneManager.GetActiveScene().name);</span></span><br><span class="line">        Debug.Log(<span class="string">&quot;restart&quot;</span>);</span><br><span class="line">        restartButton.SetActive(<span class="literal">false</span>);</span><br><span class="line">        startButton.SetActive(<span class="literal">true</span>);</span><br><span class="line">        gameStart = <span class="literal">false</span>;</span><br><span class="line">        GameObject[] balls = GameObject.FindGameObjectsWithTag(<span class="string">&quot;Ball&quot;</span>);</span><br><span class="line">        <span class="keyword">foreach</span>(GameObject gb <span class="keyword">in</span> balls)</span><br><span class="line">            Destroy(gb);</span><br><span class="line">        GameObject[] spins = GameObject.FindGameObjectsWithTag(<span class="string">&quot;Spin&quot;</span>);</span><br><span class="line">        <span class="keyword">foreach</span>(GameObject gb <span class="keyword">in</span> spins)</span><br><span class="line">        &#123;</span><br><span class="line">            gb.GetComponent&lt;HingeJoint&gt;().useMotor = <span class="literal">false</span>;</span><br><span class="line">            gb.GetComponent&lt;Rigidbody&gt;().isKinematic = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        GameObject[] prefabs =  GameObject.FindGameObjectsWithTag(<span class="string">&quot;character&quot;</span>);</span><br><span class="line">        <span class="keyword">foreach</span>(GameObject gb <span class="keyword">in</span> prefabs)</span><br><span class="line">        &#123;</span><br><span class="line">            Rigidbody[] bodys =  gb.GetComponentsInChildren&lt;Rigidbody&gt;();</span><br><span class="line">            <span class="keyword">foreach</span>(Rigidbody rb <span class="keyword">in</span> bodys)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(rb.transform == rb.transform.root)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                rb.useGravity = <span class="literal">false</span>;</span><br><span class="line">                rb.isKinematic = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// HingeJoint jt = GetComponentsInChildren&lt;HingeJoint&gt;();</span></span><br><span class="line">            <span class="comment">// FixedJoint jt = GetComponentsInChildren&lt;FixedJoint&gt;();</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sucessGame</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Debug.Log(<span class="string">&quot;???&quot;</span>);</span><br><span class="line">        sucesstext.SetActive(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">QuitGame</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        GameRestart();</span><br><span class="line">        SceneManager.LoadScene(<span class="string">&quot;StartScene&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Update is called once per frame</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// swtich camera</span></span><br><span class="line">        <span class="keyword">if</span>(gameStart &amp;&amp; SceneManager.GetActiveScene().name == <span class="string">&quot;SpinCrazy&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            totalTime += Time.deltaTime;</span><br><span class="line">            <span class="keyword">if</span>(totalTime &gt; <span class="number">4f</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                totalTime -= <span class="number">4f</span>;</span><br><span class="line">                Vector3 spawnPosition = spawn.position;</span><br><span class="line">                spawnPosition.z += <span class="number">1.5f</span>;</span><br><span class="line">                GameObject rball = Instantiate(ball, spawnPosition, spawn.rotation);</span><br><span class="line">                rball.GetComponent&lt;Rigidbody&gt;().mass = <span class="number">1f</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(gameStart &amp;&amp; SceneManager.GetActiveScene().name == <span class="string">&quot;Mathematician&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            totalTime += Time.deltaTime;</span><br><span class="line">            <span class="keyword">if</span>(totalTime &gt; <span class="number">2f</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                totalTime -= <span class="number">2f</span>;</span><br><span class="line">                Vector3 spawnPosition = spawn.position;</span><br><span class="line">                <span class="comment">// spawnPosition.z += 1.5f;</span></span><br><span class="line">                GameObject rball = Instantiate(ball, spawnPosition, spawn.rotation);</span><br><span class="line">                rball.GetComponent&lt;Rigidbody&gt;().velocity = <span class="keyword">new</span> Vector3(Random.Range(<span class="number">-5f</span>,<span class="number">5f</span>),<span class="number">-20f</span>,<span class="number">0</span>);</span><br><span class="line">                <span class="comment">// rball.transform.localScale = new Vector3(5f,5f,5f);</span></span><br><span class="line">                <span class="comment">// rball.GetComponent&lt;Rigidbody&gt;().mass /= 10f;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(Input.GetKeyDown(KeyCode.T))</span><br><span class="line">        &#123;</span><br><span class="line">            flag = !flag;</span><br><span class="line">            moveCamera.SetActive(!flag);</span><br><span class="line">            mainCamera.SetActive(flag);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(Input.GetKeyDown(<span class="string">&quot;g&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// rotate = !rotate;</span></span><br><span class="line">            button.GetComponent&lt;SwitchButton&gt;().Switch();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// mouse selection</span></span><br><span class="line">        <span class="keyword">if</span>(Input.GetMouseButtonDown(<span class="number">0</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            Ray ray = Camera.main.ScreenPointToRay(Input.mousePosition);</span><br><span class="line">            RaycastHit hit;</span><br><span class="line">            <span class="built_in">int</span> layermasek = (<span class="number">1</span> &lt;&lt; <span class="number">3</span>);</span><br><span class="line">            <span class="built_in">bool</span> isCollider = Physics.Raycast(ray, <span class="keyword">out</span> hit, maxDistance: Mathf.Infinity, layermasek);</span><br><span class="line">            Debug.Log(isCollider);</span><br><span class="line">            <span class="keyword">if</span>(isCollider &amp;&amp; !EventSystem.current.IsPointerOverGameObject())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// Debug.Log(hit.collider.gameObject.name);</span></span><br><span class="line">                Debug.Log(hit.collider.gameObject.name);</span><br><span class="line">                <span class="keyword">if</span>(hit.collider.gameObject.layer == <span class="number">3</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    onCatch = <span class="literal">true</span>;</span><br><span class="line">                    selected = hit.collider.gameObject.transform.root;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    onCatch = <span class="literal">false</span>;</span><br><span class="line">            &#125;       </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(Input.GetMouseButton(<span class="number">1</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            moveCamera.GetComponent&lt;MoveCameraController&gt;().Move();</span><br><span class="line">            Debug.Log(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(onCatch)</span><br><span class="line">            &#123;   </span><br><span class="line">                selected.gameObject.GetComponentInChildren&lt;MoveCharacter&gt;().Move();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">            &#123;</span><br><span class="line">                moveCamera.GetComponent&lt;MoveCameraController&gt;().Move();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetRotate</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        rotate = !rotate;</span><br><span class="line">        button.GetComponent&lt;SwitchButton&gt;().Switch();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1>6. 运行环境配置及游戏测试</h1>
<ul>
<li>
<p>测试平台</p>
<p>显卡 GTX 1060 (6GB)</p>
<p>CPU intel 10600kf</p>
<p>内存 32GB</p>
<p>分辨率 3840 * 2160</p>
</li>
<li>
<p>游戏测试</p>
<p>测试下来已有的三个关卡都能流畅运行, 偶有物理效果方面的bug, 玩家点击游戏内的 Restart 按钮之后即可解决.</p>
<p>前两个关卡均可通过. 第三关的话, 首先还没制作胜利结果判定, 其次做了我也玩不过…</p>
</li>
</ul>
<h1>7. 课程小结</h1>
<p>设计这款游戏的初衷是希望赋予玩家尽可能高的自由度,为他们提供一个能自由探索, 思考, 实践自己的想法的平台. 最后实现的效果也基本如一开始所设想, 可惜的是因为时间不够充裕, 目前还只有三个关卡, 并且解法的自由度也不是很高. 后续希望能够设计出更加复杂, 巧妙的关卡展现出这个游戏真正的魅力.</p>
<p>只是, 虽然实现了高自由度的控制, 但受限于只能用键盘鼠标来操作身体, 游戏的操作难度相当之大, 导致操作体验并不是很好. 制作完这个游戏之后, 我也理解了为什么大多数游戏的操作都比较简单, 毕竟玩家的输入方式的限制在这, 就算实现了更复杂的操作方式玩家也操作不来.</p>
<p>虽然制作这个游戏的过程确实十分有趣. 但我也同时感受到了技术上的限制. 所以现在更想做的是探索游戏底层技术的创新, 实现更真实的游戏引擎, 更丰富的交互方式, 用技术的进步去真正带动玩法上的创新.</p>
<p>感谢游戏项目实践这门课让我完整地体验了一个游戏的制作过程. 感谢晨辉老师用心准备的课程内容和耐心的实践指导, 一个学期下来收获了很多, 希望这门课能一直开下去, 让更多的同学感受到游戏制作的魅力.</p>
</article><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://ding-typora.oss-cn-beijing.aliyuncs.com/img/RIOPY_RIOPY.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/ACM/DP/ACM/DP/%E6%9E%84%E9%80%A0&amp;%E8%B4%AA%E5%BF%83/"><img class="prev-cover" data-lazy-src="https://ding-typora.oss-cn-beijing.aliyuncs.com/img/%E6%9B%BE%E8%BD%B6%E5%8F%AF_anti-yico!.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info"></div></div></a></div><div class="next-post pull-right"><a href="/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/Lab6/"><img class="next-cover" data-lazy-src="https://ding-typora.oss-cn-beijing.aliyuncs.com/img/%E7%A6%8F%E7%A6%84%E5%AF%BF_%E6%88%91%E7%94%A8%E4%BB%80%E4%B9%88%E6%8A%8A%E4%BD%A0%E7%95%99%E4%BD%8F.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">ucore - Lab6 调度器</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="/img/qwq_circle2.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">qwqbot</div><div class="author-info__description">CS-ACM-MUSIC-REANGDING-MOVIE</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">84</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">29</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">29</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pwqbot"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:974314484@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">1.项目简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">2.游戏创意</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">3. 概要设计</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">4. 详细设计</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%93%8D%E4%BD%9C%E8%AE%BE%E8%AE%A1"><span class="toc-text">1. 操作设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%B0%8F%E4%BA%BA"><span class="toc-text">生成小人</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%91%84%E5%83%8F%E6%9C%BA%E6%8E%A7%E5%88%B6"><span class="toc-text">摄像机控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E4%BA%BA%E6%8E%A7%E5%88%B6"><span class="toc-text">小人控制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%85%B3%E5%8D%A1%E8%AE%BE%E8%AE%A1"><span class="toc-text">2. 关卡设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E5%8D%A11-KinderGarden"><span class="toc-text">关卡1 : KinderGarden</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E5%8D%A12-Spin-Crazy"><span class="toc-text">关卡2 : Spin Crazy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E5%8D%A13-Mathematician"><span class="toc-text">关卡3 : Mathematician</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-UI-%E7%BE%8E%E6%9C%AF-%E9%9F%B3%E6%95%88"><span class="toc-text">3. UI&#x2F;美术&#x2F;音效</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#UI"><span class="toc-text">UI</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B%E7%95%8C%E9%9D%A2"><span class="toc-text">开始界面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9CUI"><span class="toc-text">操作UI</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#UI-2"><span class="toc-text">UI</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BE%8E%E6%9C%AF"><span class="toc-text">美术</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%85%B3-KinderGarden"><span class="toc-text">第一关 : KinderGarden</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%85%B3-Spin-Crazy"><span class="toc-text">第二关 : Spin Crazy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%85%B3-Mathematician"><span class="toc-text">第三关 : Mathematician</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9F%B3%E6%95%88"><span class="toc-text">音效</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">5.编程实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%A7%BB%E5%8A%A8%E6%97%8B%E8%BD%AC%E6%8E%A7%E5%88%B6"><span class="toc-text">1. 移动旋转控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%82%A2%E4%BD%93%E6%8E%A7%E5%88%B6"><span class="toc-text">2.   肢体控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%A7%92%E8%89%B2%E5%88%9B%E5%BB%BA"><span class="toc-text">3.   角色创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%9C%B0%E5%BD%A2%E5%90%B8%E9%99%84"><span class="toc-text">4.地形吸附</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%96%AD%E8%82%A2%E6%95%88%E6%9E%9C-%E6%9C%AA%E5%AE%9E%E8%A3%85"><span class="toc-text">5.断肢效果(未实装)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%80%BB%E6%8E%A7%E4%BB%A3%E7%A0%81"><span class="toc-text">6. 总控代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">6. 运行环境配置及游戏测试</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">7. 课程小结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最近更新</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/CS0804n/Tools/CS0804n/Tools/vim/" title="vim 备忘录"><img data-lazy-src="https://ding-typora.oss-cn-beijing.aliyuncs.com/img/%E4%B8%87%E8%83%BD%E9%9D%92%E5%B9%B4%E6%97%85%E5%BA%97_%E6%99%8B%E8%A5%BF%E5%8D%97%E6%9E%97%E8%B7%AF%E8%A1%8C.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="vim 备忘录"/></a><div class="content"><a class="title" href="/CS0804n/Tools/CS0804n/Tools/vim/" title="vim 备忘录">vim 备忘录</a><time datetime="2021-10-09T14:59:56.617Z" title="更新于 2021-10-09 22:59:56">2021-10-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/gdb%E8%B0%83%E8%AF%95%E5%91%BD%E4%BB%A4/" title="gdb调试命令"><img data-lazy-src="https://ding-typora.oss-cn-beijing.aliyuncs.com/img/%E6%9B%BE%E8%BD%B6%E5%8F%AF_anti-yico!.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="gdb调试命令"/></a><div class="content"><a class="title" href="/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/gdb%E8%B0%83%E8%AF%95%E5%91%BD%E4%BB%A4/" title="gdb调试命令">gdb调试命令</a><time datetime="2021-10-09T09:35:17.829Z" title="更新于 2021-10-09 17:35:17">2021-10-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/Lab3/" title="ucore - Lab3 虚拟内存管理"><img data-lazy-src="https://ding-typora.oss-cn-beijing.aliyuncs.com/img/Manchester%20by%20the%20Sea.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ucore - Lab3 虚拟内存管理"/></a><div class="content"><a class="title" href="/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/Lab3/" title="ucore - Lab3 虚拟内存管理">ucore - Lab3 虚拟内存管理</a><time datetime="2021-10-09T09:34:51.819Z" title="更新于 2021-10-09 17:34:51">2021-10-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/Lab2/" title="ucore - Lab2 物理内存管理"><img data-lazy-src="https://ding-typora.oss-cn-beijing.aliyuncs.com/img/Sufjan%20Stevens_Carrie&amp;Lowell.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ucore - Lab2 物理内存管理"/></a><div class="content"><a class="title" href="/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/Lab2/" title="ucore - Lab2 物理内存管理">ucore - Lab2 物理内存管理</a><time datetime="2021-10-09T09:34:49.836Z" title="更新于 2021-10-09 17:34:49">2021-10-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/Lab1/" title="ucore - Lab1 系统软件的启动过程"><img data-lazy-src="http://ding-typora.oss-cn-beijing.aliyuncs.com/img/20130916100832359" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ucore - Lab1 系统软件的启动过程"/></a><div class="content"><a class="title" href="/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/CS0804n/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/Lab1/" title="ucore - Lab1 系统软件的启动过程">ucore - Lab1 系统软件的启动过程</a><time datetime="2021-10-09T09:34:47.464Z" title="更新于 2021-10-09 17:34:47">2021-10-09</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 By qwqbot</div><div class="footer_custom_text">福禄寿伴你左右</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', '', 'katex-wrap')
  })
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>